
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/generated/linear_regression_sealevel.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_generated_linear_regression_sealevel.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_generated_linear_regression_sealevel.py:


Linear regression with Eustatic Sea-level data
==============================================

.. GENERATED FROM PYTHON SOURCE LINES 9-14

|Open In Colab|

.. |Open In Colab| image:: https://img.shields.io/badge/open%20in-Colab-b5e2fa?logo=googlecolab&style=flat-square&color=ffd670
   :target: https://colab.research.google.com/github/inlab-geo/cofi-examples/blob/main/examples/linear_regression/linear_regression_sealevel.ipynb


.. GENERATED FROM PYTHON SOURCE LINES 17-24

If you are running this notebook locally, make sure you’ve followed
`steps
here <https://github.com/inlab-geo/cofi-examples#run-the-examples-with-cofi-locally>`__
to set up the environment. (This
`environment.yml <https://github.com/inlab-geo/cofi-examples/blob/main/envs/environment.yml>`__
file specifies a list of packages required to run the notebooks)


.. GENERATED FROM PYTHON SOURCE LINES 27-47

--------------

What we do in this notebook
---------------------------

Here we demonstrate use of CoFI on a real dataset **linear regression**
problem, where we fit a polynomial function to Eustatic Sea-level
heights.

-  by solution of a linear system of equations,
-  by optimization of a data misfit function
-  by Bayesian sampling of a Likelihood multiplied by a prior.

--------------

Data set is from “Sea level and global ice volumes from the Last Glacial
Maximum to the Holocene” K. Lambeck, H. Rouby, A. Purcell, Y. Sun, and
M. Sambridge, 2014. Proc. Nat. Acad. Sci., 111, no. 43, 15296-15303,
doi:10.1073/pnas.1411762111.


.. GENERATED FROM PYTHON SOURCE LINES 47-52

.. code-block:: default


    # Environment setup (uncomment code below)

    # !pip install -U cofi








.. GENERATED FROM PYTHON SOURCE LINES 57-60

Remember to uncomment and run the code cell below as well, as we are
going to load some data from GitHub.


.. GENERATED FROM PYTHON SOURCE LINES 60-64

.. code-block:: default


    # !git clone https://github.com/inlab-geo/cofi-examples.git
    # %cd cofi-examples/examples/linear_regression








.. GENERATED FROM PYTHON SOURCE LINES 69-74

Linear regression
-----------------

Lets start with some (x,y) data.


.. GENERATED FROM PYTHON SOURCE LINES 74-78

.. code-block:: default


    import numpy as np
    import matplotlib.pyplot as plt








.. GENERATED FROM PYTHON SOURCE LINES 80-118

.. code-block:: default


    #
    def load_data_xy(filename):

        f = open(filename, 'r')
        header = f.readline()
        lines = f.readlines()

        x = np.array([])
        y = np.array([])
        sx = np.array([])
        sy = np.array([])
        for line in lines:
            columns = line.split()
            x = np.append(x,float(columns[0]))
            y = np.append(y,float(columns[1]))
            sx = np.append(sx,float(columns[2])/2.0)
            sy = np.append(sy,float(columns[3])/2.0)

        d = x,y, sy                                   # Combine into a single data structure

        return d

    def load_data_ref(filename):

        f = open(filename, 'r')
        lines = f.readlines()
        dx = np.array([]) # Age data
        dy = np.array([]) # ESL height
        dz = np.array([]) # derivative of ESL w.r.t. age
        for line in lines:
            columns = line.split()
            dx = np.append(dx,float(columns[0]))
            dy = np.append(dy,float(columns[1]))
        datavals = np.column_stack((dx,dy))  # Stack data

        return datavals








.. GENERATED FROM PYTHON SOURCE LINES 120-123

.. code-block:: default


    data_x,data_y,sy = load_data_xy("ESL-ff11-sorted.txt")  # Load x,sx,y,sy ESL data (x=time, Y=ESL)








.. GENERATED FROM PYTHON SOURCE LINES 125-129

.. code-block:: default


    maxtime = 20.
    ndata = np.where(data_x>maxtime)[0][0]








.. GENERATED FROM PYTHON SOURCE LINES 131-134

.. code-block:: default


    data_x,data_y,sy = data_x[:ndata],data_y[:ndata],sy[:ndata]








.. GENERATED FROM PYTHON SOURCE LINES 139-141

And now lets plot the data.


.. GENERATED FROM PYTHON SOURCE LINES 141-150

.. code-block:: default


    def plot_data(x=data_x,y=data_y,sigma=sy,title=None):
        fig, axes = plt.subplots(figsize=(9,6))
        plt.errorbar(x, y, yerr=sy, fmt='.',color="lightcoral",ecolor='lightgrey',ms=2)
        plt.xlabel(' Time before present (ka)')
        plt.ylabel(' ESL height (m)')
        if(title != None): plt.title(title)
    plot_data(title='Eustatic sea-level')




.. image-sg:: /examples/generated/images/sphx_glr_linear_regression_sealevel_001.png
   :alt: Eustatic sea-level
   :srcset: /examples/generated/images/sphx_glr_linear_regression_sealevel_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 155-194

Problem description
-------------------

To begin with, we will work with polynomial curves,

.. math:: y(x) = \sum_{j=0}^M m_j x^j\,.

Here, :math:`M` is the ‘order’ of the polynomial: if :math:`M=1` we have
a straight line with 2 parameters, if :math:`M=2` it will be a quadratic
with 3 parameters, and so on. The :math:`m_j, (j=0,\dots M)` are the
‘model coefficients’ that we seek to constrain from the data.

For this class of problem the forward operator takes the following form:

.. math::  \left(\begin{array}{c}y_0\\y_1\\\vdots\\y_N\end{array}\right) = \left(\begin{array}{ccc}1&x_0&x_0^2&x_0^3\\1&x_1&x_1^2&x_1^3\\\vdots&\vdots&\vdots\\1&x_N&x_N^2&x_N^3\end{array}\right)\left(\begin{array}{c}m_0\\m_1\\m_2\end{array}\right)

This clearly has the required general form,
:math:`\mathbf{d} =G{\mathbf m}`.

where:

-  :math:`\textbf{d}` is the vector of data values,
   (:math:`y_0,y_1,\dots,y_N`);
-  :math:`\textbf{m}` is the vector of model parameters,
   (:math:`m_0,m_1,m_2`);
-  :math:`G` is the basis matrix (or design matrix) of this linear
   regression problem (also called the **Jacobian** matrix for this
   linear problem).

We have a set of noisy data values, :math:`y_i (i=0,\dots,N)`, measured
at known locations, :math:`x_i (i=0,\dots,N)`, and wish to find the best
fit degree 3 polynomial.

The function that generated our data is assumed to have independent
Gaussian random noise, :math:`{\cal N}(0,\Sigma)`, with
:math:`(\Sigma)_{ij} = \delta_{ij}/\sigma_i^2`, where the variance of
the noise on each datum, :math:`\sigma_i^2 (i=1,\dots,N)`, differs
between observations and is given.


.. GENERATED FROM PYTHON SOURCE LINES 197-200

We now build the Jacobian/G matrix for this problem and define a forward
function which simply multiplies :math:`\mathbf m` by :math:`G`.


.. GENERATED FROM PYTHON SOURCE LINES 200-213

.. code-block:: default


    nparams = 5 # Number of model parameters to be solved for

    def jacobian(x=data_x, n=nparams):
        return np.array([x**i for i in range(n)]).T

    def forward(model):
        return jacobian().dot(model)

    def Cd_inv(sigma=sy):
        factor= 10                                   # factor to inflate observational errors
        return np.diag(1./sy*1./sy)/(factor**2)








.. GENERATED FROM PYTHON SOURCE LINES 218-220

Define a reference model for later.


.. GENERATED FROM PYTHON SOURCE LINES 220-227

.. code-block:: default


    # Reference model for plotting
    ESLref = load_data_ref("ESL-f11_yonly.txt") # Load x, y, z reference model and estimated derivative (x=time, Y=ESL, z=dESL/dt) 
    ndata2 = np.where(ESLref.T[0]>maxtime)[0][0]
    ESLref = ESLref[:ndata2]
    ref_x,ref_y = ESLref.T[0],ESLref.T[1]








.. GENERATED FROM PYTHON SOURCE LINES 232-234

Now lets plot the data with the reference curve


.. GENERATED FROM PYTHON SOURCE LINES 234-249

.. code-block:: default


    # Some plotting utilities
    def plot_model(x,y, label, color=None,lw=0.5):
        plt.plot(x, y, color=color or "green", label=label,lw=lw)
        #plt.xlabel("X")
        #plt.ylabel("ESL")
        plt.legend()

    def plot_models(models, label="Posterior samples", color="seagreen", alpha=0.1,lw=0.5):
        G = jacobian(data_x)
        plt.plot(data_x, G.dot(models[0]), color=color, label=label, alpha=alpha,lw=lw)
        for m in models:
            plt.plot(data_x, G.dot(m), color=color, alpha=alpha,lw=lw)
        plt.legend()








.. GENERATED FROM PYTHON SOURCE LINES 251-255

.. code-block:: default


    plot_data(title="Eustatic sea-level")
    plot_model(ref_x,ref_y, "Reference model")




.. image-sg:: /examples/generated/images/sphx_glr_linear_regression_sealevel_002.png
   :alt: Eustatic sea-level
   :srcset: /examples/generated/images/sphx_glr_linear_regression_sealevel_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 260-263

Now we have the data and the forward model we can start to try and
estimate the coefficients of the polynomial from the data.


.. GENERATED FROM PYTHON SOURCE LINES 266-307

The structure of CoFI 
----------------------

In the workflow of ``cofi``, there are three main components:
``BaseProblem``, ``InversionOptions``, and ``Inversion``.

-  ``BaseProblem`` defines the inverse problem including any user
   supplied quantities such as data vector, number of model parameters
   and measure of fit between model predictions and data.
   ``python     inv_problem = BaseProblem()     inv_problem.set_objective(some_function_here)     inv_problem.set_jacobian(some_function_here)     inv_problem.set_initial_model(a_starting_point) # if needed, e.g. we are solving a nonlinear problem by optimization``

    

-  ``InversionOptions`` describes details about how one wants to run the
   inversion, including the backend tool and solver-specific parameters.
   It is based on the concept of a ``method`` and ``tool``.

   .. code:: python

      inv_options = InversionOptions()
      inv_options.suggest_solving_methods()
      inv_options.set_solving_method("matrix solvers")
      inv_options.suggest_tools()
      inv_options.set_tool("scipy.linalg.lstsq")
      inv_options.summary()

    

-  ``Inversion`` can be seen as an inversion engine that takes in the
   above two as information, and will produce an ``InversionResult``
   upon running.

   .. code:: python

      inv = Inversion(inv_problem, inv_options)
      result = inv.run()

Internally CoFI decides the nature of the problem from the quantities
set by the user and performs internal checks to ensure it has all that
it needs to solve a problem.


.. GENERATED FROM PYTHON SOURCE LINES 310-313

1. Linear system solver
-----------------------


.. GENERATED FROM PYTHON SOURCE LINES 313-316

.. code-block:: default


    from cofi import BaseProblem, InversionOptions, Inversion








.. GENERATED FROM PYTHON SOURCE LINES 321-324

Step 1. Define CoFI ``BaseProblem``
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


.. GENERATED FROM PYTHON SOURCE LINES 324-330

.. code-block:: default


    inv_problem = BaseProblem()
    inv_problem.set_data(data_y)
    inv_problem.set_jacobian(jacobian())
    inv_problem.set_data_covariance_inv(Cd_inv())








.. GENERATED FROM PYTHON SOURCE LINES 335-338

Step 2. Define CoFI ``InversionOptions``
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


.. GENERATED FROM PYTHON SOURCE LINES 338-341

.. code-block:: default


    inv_options = InversionOptions()








.. GENERATED FROM PYTHON SOURCE LINES 346-349

Using the information supplied, we can ask CoFI to suggest some solving
methods.


.. GENERATED FROM PYTHON SOURCE LINES 349-352

.. code-block:: default


    inv_options.suggest_solving_methods()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    The following solving methods are supported:
    {'optimization', 'matrix solvers', 'sampling'}

    Use `suggest_tools()` to see a full list of backend tools for each method




.. GENERATED FROM PYTHON SOURCE LINES 357-359

We can ask CoFI to suggest some specific software tools as well.


.. GENERATED FROM PYTHON SOURCE LINES 359-362

.. code-block:: default


    inv_options.suggest_tools()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Here's a complete list of inversion solvers supported by CoFI (grouped by methods):
    {
        "optimization": [
            "scipy.optimize.minimize",
            "scipy.optimize.least_squares",
            "torch.optim"
        ],
        "matrix solvers": [
            "scipy.linalg.lstsq",
            "cofi.simple_newton"
        ],
        "sampling": [
            "emcee"
        ]
    }




.. GENERATED FROM PYTHON SOURCE LINES 364-368

.. code-block:: default


    inv_options.set_solving_method("matrix solvers") # lets decide to use a matrix solver.
    inv_options.summary()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    =============================
    Summary for inversion options
    =============================
    Solving method: matrix solvers
    Use `suggest_solving_methods()` to check available solving methods.
    -----------------------------
    Backend tool: `scipy.linalg.lstsq (by default)` - SciPy's wrapper function over LAPACK's linear least-squares solver, using 'gelsd', 'gelsy' (default), or 'gelss' as backend driver
    References: ['https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.lstsq.html', 'https://www.netlib.org/lapack/lug/node27.html']
    Use `suggest_tools()` to check available backend tools.
    -----------------------------
    Solver-specific parameters: None set
    Use `suggest_solver_params()` to check required/optional solver-specific parameters.




.. GENERATED FROM PYTHON SOURCE LINES 370-374

.. code-block:: default


    # below is optional, as this has already been the default tool under "linear least square"
    inv_options.set_tool("scipy.linalg.lstsq")








.. GENERATED FROM PYTHON SOURCE LINES 379-397

Step 3. Define CoFI ``Inversion`` and run
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Our choices so far have defined a linear parameter estimation problem
(without any regularization) to be solved within a least squares
framework. In this case the selection of a ``matrix solvers`` method
will mean we are calculating the standard least squares solution

.. math::


   m = (G^T C_d^{-1} G)^{-1} G^T C_d^{-1} d

and our choice of backend tool ``scipy.linalg.lstsq``, means that we
will employ scipy’s ``linalg`` package to perform the numerics.

Lets run CoFI.


.. GENERATED FROM PYTHON SOURCE LINES 397-401

.. code-block:: default


    inv = Inversion(inv_problem, inv_options)
    inv_result = inv.run()








.. GENERATED FROM PYTHON SOURCE LINES 403-407

.. code-block:: default


    print(f"The inversion result from `scipy.linalg.lstsq`: {inv_result.model}\n")
    inv_result.summary()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    The inversion result from `scipy.linalg.lstsq`: [ 1.44051039 -3.11381469  1.412872   -0.20910136  0.00653572]

    ============================
    Summary for inversion result
    ============================
    SUCCESS
    ----------------------------
    model: [ 1.44051039 -3.11381469  1.412872   -0.20910136  0.00653572]
    sum_of_squared_residuals: []
    effective_rank: 5
    singular_values: [1.72339368e+09 1.35569994e+06 3.54123758e+03 1.10384400e+02
     7.16903392e+00]
    model_covariance: [[ 6.70145209e-02 -6.28173834e-02  1.67266578e-02 -1.60867740e-03
       4.77025592e-05]
     [-6.28173834e-02  7.43365995e-02 -2.23488563e-02  2.32179303e-03
      -7.20214235e-05]
     [ 1.67266578e-02 -2.23488563e-02  7.38371078e-03 -8.20763652e-04
       2.65025504e-05]
     [-1.60867740e-03  2.32179303e-03 -8.20763652e-04  9.62437921e-05
      -3.21300646e-06]
     [ 4.77025592e-05 -7.20214235e-05  2.65025504e-05 -3.21300646e-06
       1.10114955e-07]]




.. GENERATED FROM PYTHON SOURCE LINES 412-414

Lets plot the solution.


.. GENERATED FROM PYTHON SOURCE LINES 414-419

.. code-block:: default


    plot_data(title="Eustatic sea-level")
    plot_model(data_x,jacobian(data_x).dot(inv_result.model), "linear system solver", color="seagreen")
    plot_model(ref_x,ref_y, "Reference model", color="darkorange")




.. image-sg:: /examples/generated/images/sphx_glr_linear_regression_sealevel_003.png
   :alt: Eustatic sea-level
   :srcset: /examples/generated/images/sphx_glr_linear_regression_sealevel_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 424-449

2. Optimizer
------------

The same overdetermined linear problem,
:math:`\textbf{d} = G\textbf{m}`, with Gaussian data noise can also be
solved by minimising the squares of the residual of the linear
equations, e.g. :math:`\textbf{r}^T \textbf{C}_d^{-1}\textbf{r}` where
:math:`\textbf{r}=\textbf{d}-G\textbf{m}`. The above matrix solver
solution gives us the best data fitting model, but a direct optimisation
approach could also be used, say when the number of unknowns is large
and we do not wish, or are unable to provide the Jacobian function.

So we use a plain optimizer ``scipy.optimize.minimize`` to demonstrate
this ability.

.. raw:: html

   <!-- For this backend solver to run successfully, some additional information should be provided, otherwise
   you'll see an error to notify what additional information is required by the solver.

   There are several ways to provide the information needed to solve an inverse problem with 
   CoFI. In the example below we provide functions to calculate the data and the optional 
   regularisation. CoFI then generates the objective function for us based on the information 
   provided. The alternative to this would be to directly provide objective function to CoFI. -->


.. GENERATED FROM PYTHON SOURCE LINES 449-472

.. code-block:: default


    ######## CoFI BaseProblem - provide additional information
    inv_problem.set_initial_model(np.ones(nparams))
    #inv_problem.set_initial_model(inv_result.model)
    inv_problem.set_forward(forward)
    inv_problem.set_data_misfit("squared error")

    # inv_problem.set_objective(your_own_misfit_function)    # (optionally) if you'd like to define your own misfit
    # inv_problem.set_gradient(your_own_gradient_of_misfit_function)    # (optionally) if you'd like to define your own misfit gradient

    ######## CoFI InversionOptions - set a different tool
    inv_options_2 = InversionOptions()
    inv_options_2.set_tool("scipy.optimize.minimize")
    inv_options_2.set_params(method="Nelder-Mead")

    ######## CoFI Inversion - run it
    inv_2 = Inversion(inv_problem, inv_options_2)
    inv_result_2 = inv_2.run()

    ######## CoFI InversionResult - check result
    print(f"The inversion result from `scipy.optimize.minimize`: {inv_result_2.model}\n")
    inv_result_2.summary()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    The inversion result from `scipy.optimize.minimize`: [ 4.02211771 -7.6352002   3.47983694 -0.52237961  0.02043681]

    ============================
    Summary for inversion result
    ============================
    FAILURE
    ----------------------------
    fun: 396.30180936007037
    nit: 598
    nfev: 1000
    status: 1
    message: Maximum number of function evaluations has been exceeded.
    final_simplex: (array([[ 4.02211771, -7.6352002 ,  3.47983694, -0.52237961,  0.02043681],
           [ 4.02227491, -7.63498804,  3.47977907, -0.52238912,  0.02043829],
           [ 4.02218792, -7.63507241,  3.47979137, -0.5223722 ,  0.02043577],
           [ 4.02245903, -7.63488993,  3.47966829, -0.52235893,  0.02043602],
           [ 4.02257488, -7.63525136,  3.47962954, -0.52233062,  0.02043424],
           [ 4.02215782, -7.63502984,  3.47981924, -0.5223883 ,  0.02043736]]), array([396.30180936, 396.30181593, 396.30181983, 396.30182837,
           396.30183836, 396.30184074]))
    model: [ 4.02211771 -7.6352002   3.47983694 -0.52237961  0.02043681]




.. GENERATED FROM PYTHON SOURCE LINES 474-479

.. code-block:: default


    plot_data()
    plot_model(data_x,jacobian(data_x).dot(inv_result_2.model), "optimization solution", color="cornflowerblue")
    plot_model(ref_x,ref_y, "Reference model", color="darkorange")




.. image-sg:: /examples/generated/images/sphx_glr_linear_regression_sealevel_004.png
   :alt: linear regression sealevel
   :srcset: /examples/generated/images/sphx_glr_linear_regression_sealevel_004.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 484-487

The optimization fails to convergence for this problem (with default
settings).


.. GENERATED FROM PYTHON SOURCE LINES 490-492

--------------


.. GENERATED FROM PYTHON SOURCE LINES 495-519

Challenge - Change the polynomial degree
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Try and replace the 3rd order polynomial with a 2nd order polynomial
(i.e. :math:`M=2`) by adding the required commands below. What does the
plot looks like?

Start from code below:

::

   inv_problem = BaseProblem()
   inv_problem.set_data(data_y)
   inv_problem.set_jacobian(jacobian(n=<CHANGE ME>))
   inv_problem.set_data_covariance_inv(Cd_inv())
   inv_options.set_solving_method("matrix solvers") # lets decide to use a matrix solver.
   inv = Inversion(inv_problem, inv_options)
   inv_result = inv.run()

   print("Inferred curve with n = <CHANGE ME> ")
   plot_data()
   plot_model(data_x,jacobian(x,n=<CHANGE ME>).dot(inv_result.model), "optimization solution", color="cornflowerblue")
   plot_model(ref_x,ref_y, "Reference model", color="darkorange")


.. GENERATED FROM PYTHON SOURCE LINES 519-524

.. code-block:: default


    # Copy the template above, Replace <CHANGE ME> with your answer










.. GENERATED FROM PYTHON SOURCE LINES 526-542

.. code-block:: default


    #@title Solution

    inv_problem = BaseProblem()
    inv_problem.set_data(data_y)
    inv_problem.set_jacobian(jacobian(n=3))
    inv_problem.set_data_covariance_inv(Cd_inv())
    inv_options.set_solving_method("matrix solvers") # lets decide to use a matrix solver.
    inv = Inversion(inv_problem, inv_options)
    inv_result = inv.run()

    print("Inferred curve with n = 3 ")
    plot_data()
    plot_model(data_x,jacobian(data_x,n=3).dot(inv_result.model), "optimization solution", color="cornflowerblue")
    plot_model(ref_x,ref_y, "Reference model", color="darkorange")




.. image-sg:: /examples/generated/images/sphx_glr_linear_regression_sealevel_005.png
   :alt: linear regression sealevel
   :srcset: /examples/generated/images/sphx_glr_linear_regression_sealevel_005.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Inferred curve with n = 3 




.. GENERATED FROM PYTHON SOURCE LINES 547-550

Changing to a second order polynomial does converge but gives a poor
fit.


.. GENERATED FROM PYTHON SOURCE LINES 553-555

--------------


.. GENERATED FROM PYTHON SOURCE LINES 558-561

3. Bayesian sampling
--------------------


.. GENERATED FROM PYTHON SOURCE LINES 564-587

Likelihood
~~~~~~~~~~

Since data errors follow a Gaussian in this example, we can define a
Likelihood function, :math:`p({\mathbf d}_{obs}| {\mathbf m})`.

.. math::


   p({\mathbf d}_{obs} | {\mathbf m}) \propto \exp \left\{- \frac{1}{2} ({\mathbf d}_{obs}-{\mathbf d}_{pred}({\mathbf m}))^T C_D^{-1} ({\mathbf d}_{obs}-{\mathbf d}_{pred}({\mathbf m})) \right\}

where :math:`{\mathbf d}_{obs}` represents the observed y values and
:math:`{\mathbf d}_{pred}({\mathbf m})` are those predicted by the
polynomial model :math:`({\mathbf m})`. The Likelihood is defined as the
probability of observing the data actually observed, given a model. In
practice we usually only need to evaluate the log of the Likelihood,
:math:`\log p({\mathbf d}_{obs} | {\mathbf m})`. To do so, we require
the inverse data covariance matrix describing the statistics of the
noise in the data, :math:`C_D^{-1}` . For this problem the data errors
are independent with identical standard deviation in noise for each
datum. Hence :math:`C_D^{-1} = \frac{1}{\sigma^2}I` where
:math:`\sigma=1`.


.. GENERATED FROM PYTHON SOURCE LINES 590-593

Here we artificially increase the observational errors on the data so
that the spread of the posterior samples are visible.


.. GENERATED FROM PYTHON SOURCE LINES 593-601

.. code-block:: default


    Cdinv = Cd_inv()                 # inverse data covariance matrix

    def log_likelihood(model):
        y_synthetics = forward(model)
        residual = data_y - y_synthetics
        return -0.5 * residual @ (Cdinv @ residual).T








.. GENERATED FROM PYTHON SOURCE LINES 606-609

Note that the user could specify **any appropriate Likelihood function**
of their choosing here.


.. GENERATED FROM PYTHON SOURCE LINES 612-636

Prior
~~~~~

Bayesian sampling requires a prior probability density function. A
common problem with polynomial coefficients as model parameters is that
it is not at all obvious what a prior should be. Here we choose a
uniform prior with specified bounds

.. math::


   \begin{align}
   p({\mathbf m}) &= \frac{1}{V},\quad  l_i \le m_i \le u_i, \quad (i=1,\dots,M)\\
   \\
            &= 0, \quad {\rm otherwise},
   \end{align}

where :math:`l_i` and :math:`u_i` are lower and upper bounds on the
:math:`i`\ th model coefficient.

Here use the uniform distribution with
:math:`{\mathbf l}^T = (-10.,-10.,-10.,-10.)`, and
:math:`{\mathbf u}^T = (10.,10.,10.,10.)`.


.. GENERATED FROM PYTHON SOURCE LINES 636-645

.. code-block:: default


    m_lower_bound = np.ones(nparams) * (-10.)             # lower bound for uniform prior
    m_upper_bound = np.ones(nparams) * 10                 # upper bound for uniform prior

    def log_prior(model):    # uniform distribution
        for i in range(len(m_lower_bound)):
            if model[i] < m_lower_bound[i] or model[i] > m_upper_bound[i]: return -np.inf
        return 0.0 # model lies within bounds -> return log(1)








.. GENERATED FROM PYTHON SOURCE LINES 650-653

Note that the user could specify **any appropriate Prior PDF** of their
choosing here.


.. GENERATED FROM PYTHON SOURCE LINES 656-677

Bayesian sampling
~~~~~~~~~~~~~~~~~

In this aproach we sample a probability distribution rather than find a
single best fit solution. Bayes’ theorem tells us the the posterior
distribution is proportional to the Likelihood and the prior.

.. math:: p(\mathbf{m}|\mathbf{d}) = K p(\mathbf{d}|\mathbf{m})p(\mathbf{m})

where :math:`K` is some constant. Under the assumptions specified
:math:`p(\mathbf{m}|\mathbf{d})` gives a probability density of models
that are supported by the data. We seek to draw random samples from
:math:`p(\mathbf{m}|\mathbf{d})` over model space and then to make
inferences from the resulting ensemble of model parameters.

In this example we make use of *The Affine Invariant Markov chain Monte
Carlo (MCMC) Ensemble sampler* `Goodman and Weare
2010 <https://msp.org/camcos/2010/5-1/p04.xhtml>`__ to sample the
posterior distribution of the model. (See more details about
`emcee <https://emcee.readthedocs.io/en/stable/>`__).


.. GENERATED FROM PYTHON SOURCE LINES 680-687

Starting points for random walkers
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Now we define some hyperparameters (e.g. the number of walkers and
steps), and initialise the starting positions of walkers. We start all
walkers in a small ball about a chosen point :math:`(0, 0, 0, 0)`.


.. GENERATED FROM PYTHON SOURCE LINES 687-693

.. code-block:: default


    nwalkers = 32
    ndim = nparams
    nsteps = 10000
    walkers_start = np.zeros(nparams) + 1e-4 * np.random.randn(nwalkers, ndim)








.. GENERATED FROM PYTHON SOURCE LINES 698-701

Add the information and run with CoFI
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


.. GENERATED FROM PYTHON SOURCE LINES 701-720

.. code-block:: default


    ######## CoFI BaseProblem - provide additional information
    inv_problem.set_log_prior(log_prior)
    inv_problem.set_log_likelihood(log_likelihood)
    inv_problem.set_walkers_starting_pos(walkers_start)

    ######## CoFI InversionOptions - get a different tool
    inv_options_3 = InversionOptions()
    inv_options_3.set_tool("emcee")      # Here we use to Affine Invariant McMC sampler from Goodman and Weare (2010).
    inv_options_3.set_params(nwalkers=nwalkers, nsteps=nsteps, progress=True)

    ######## CoFI Inversion - run it
    inv_3 = Inversion(inv_problem, inv_options_3)
    inv_result_3 = inv_3.run()

    ######## CoFI InversionResult - check result
    print(f"The inversion result from `emcee`:")
    inv_result_3.summary()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/10000 [00:00<?, ?it/s]      0%|          | 13/10000 [00:00<01:25, 116.70it/s]      0%|          | 25/10000 [00:00<02:25, 68.39it/s]       0%|          | 33/10000 [00:00<02:22, 70.16it/s]      0%|          | 41/10000 [00:00<02:23, 69.19it/s]      0%|          | 50/10000 [00:00<02:12, 75.21it/s]      1%|          | 62/10000 [00:00<01:52, 88.10it/s]      1%|          | 77/10000 [00:00<01:34, 104.58it/s]      1%|          | 91/10000 [00:00<01:27, 113.33it/s]      1%|1         | 106/10000 [00:01<01:21, 122.06it/s]      1%|1         | 121/10000 [00:01<01:17, 127.73it/s]      1%|1         | 135/10000 [00:01<01:15, 129.87it/s]      2%|1         | 150/10000 [00:01<01:13, 133.52it/s]      2%|1         | 164/10000 [00:01<01:13, 134.06it/s]      2%|1         | 179/10000 [00:01<01:12, 136.39it/s]      2%|1         | 194/10000 [00:01<01:11, 137.21it/s]      2%|2         | 208/10000 [00:01<01:16, 127.19it/s]      2%|2         | 221/10000 [00:01<01:18, 124.07it/s]      2%|2         | 234/10000 [00:02<01:18, 124.00it/s]      2%|2         | 249/10000 [00:02<01:18, 124.17it/s]      3%|2         | 264/10000 [00:02<01:15, 129.06it/s]      3%|2         | 279/10000 [00:02<01:13, 132.65it/s]      3%|2         | 294/10000 [00:02<01:11, 135.35it/s]      3%|3         | 308/10000 [00:02<01:11, 135.20it/s]      3%|3         | 323/10000 [00:02<01:10, 136.98it/s]      3%|3         | 337/10000 [00:02<01:10, 137.64it/s]      4%|3         | 351/10000 [00:02<01:10, 136.60it/s]      4%|3         | 365/10000 [00:03<01:10, 137.56it/s]      4%|3         | 380/10000 [00:03<01:09, 138.83it/s]      4%|3         | 395/10000 [00:03<01:08, 139.72it/s]      4%|4         | 410/10000 [00:03<01:08, 140.37it/s]      4%|4         | 425/10000 [00:03<01:08, 140.78it/s]      4%|4         | 440/10000 [00:03<01:07, 141.07it/s]      5%|4         | 455/10000 [00:03<01:07, 141.27it/s]      5%|4         | 470/10000 [00:03<01:07, 141.43it/s]      5%|4         | 485/10000 [00:03<01:07, 141.59it/s]      5%|5         | 500/10000 [00:03<01:07, 141.19it/s]      5%|5         | 515/10000 [00:04<01:07, 141.31it/s]      5%|5         | 530/10000 [00:04<01:06, 141.52it/s]      5%|5         | 545/10000 [00:04<01:06, 141.72it/s]      6%|5         | 560/10000 [00:04<01:06, 141.80it/s]      6%|5         | 575/10000 [00:04<01:06, 141.87it/s]      6%|5         | 590/10000 [00:04<01:06, 141.95it/s]      6%|6         | 605/10000 [00:04<01:06, 142.01it/s]      6%|6         | 620/10000 [00:04<01:06, 142.06it/s]      6%|6         | 635/10000 [00:04<01:05, 141.94it/s]      6%|6         | 650/10000 [00:05<01:06, 139.65it/s]      7%|6         | 665/10000 [00:05<01:06, 140.34it/s]      7%|6         | 680/10000 [00:05<01:06, 140.87it/s]      7%|6         | 695/10000 [00:05<01:05, 141.18it/s]      7%|7         | 710/10000 [00:05<01:05, 141.45it/s]      7%|7         | 725/10000 [00:05<01:05, 140.63it/s]      7%|7         | 740/10000 [00:05<01:23, 110.49it/s]      8%|7         | 755/10000 [00:05<01:18, 118.32it/s]      8%|7         | 768/10000 [00:06<01:24, 109.75it/s]      8%|7         | 780/10000 [00:06<01:22, 111.66it/s]      8%|7         | 795/10000 [00:06<01:16, 119.69it/s]      8%|8         | 810/10000 [00:06<01:12, 125.91it/s]      8%|8         | 825/10000 [00:06<01:10, 130.44it/s]      8%|8         | 840/10000 [00:06<01:08, 133.77it/s]      9%|8         | 855/10000 [00:06<01:07, 136.11it/s]      9%|8         | 870/10000 [00:06<01:06, 137.35it/s]      9%|8         | 885/10000 [00:06<01:05, 138.67it/s]      9%|8         | 899/10000 [00:06<01:06, 137.49it/s]      9%|9         | 914/10000 [00:07<01:05, 138.88it/s]      9%|9         | 929/10000 [00:07<01:04, 139.78it/s]      9%|9         | 944/10000 [00:07<01:04, 140.29it/s]     10%|9         | 959/10000 [00:07<01:04, 140.33it/s]     10%|9         | 974/10000 [00:07<01:04, 140.90it/s]     10%|9         | 989/10000 [00:07<01:03, 141.25it/s]     10%|#         | 1004/10000 [00:07<01:03, 141.12it/s]     10%|#         | 1019/10000 [00:07<01:06, 135.74it/s]     10%|#         | 1033/10000 [00:07<01:06, 134.78it/s]     10%|#         | 1048/10000 [00:08<01:05, 136.59it/s]     11%|#         | 1062/10000 [00:08<01:05, 135.53it/s]     11%|#         | 1076/10000 [00:08<01:05, 135.89it/s]     11%|#         | 1091/10000 [00:08<01:04, 137.76it/s]     11%|#1        | 1106/10000 [00:08<01:04, 138.79it/s]     11%|#1        | 1121/10000 [00:08<01:03, 139.69it/s]     11%|#1        | 1136/10000 [00:08<01:03, 140.30it/s]     12%|#1        | 1151/10000 [00:08<01:04, 137.54it/s]     12%|#1        | 1166/10000 [00:08<01:03, 138.89it/s]     12%|#1        | 1181/10000 [00:08<01:03, 139.84it/s]     12%|#1        | 1196/10000 [00:09<01:02, 140.51it/s]     12%|#2        | 1211/10000 [00:09<01:02, 140.98it/s]     12%|#2        | 1226/10000 [00:09<01:02, 141.35it/s]     12%|#2        | 1241/10000 [00:09<01:02, 141.19it/s]     13%|#2        | 1256/10000 [00:09<01:03, 138.23it/s]     13%|#2        | 1271/10000 [00:09<01:02, 139.33it/s]     13%|#2        | 1286/10000 [00:09<01:02, 139.82it/s]     13%|#3        | 1300/10000 [00:09<01:02, 138.24it/s]     13%|#3        | 1315/10000 [00:09<01:02, 139.22it/s]     13%|#3        | 1330/10000 [00:10<01:01, 140.03it/s]     13%|#3        | 1345/10000 [00:10<01:01, 140.63it/s]     14%|#3        | 1360/10000 [00:10<01:01, 141.09it/s]     14%|#3        | 1375/10000 [00:10<01:00, 141.40it/s]     14%|#3        | 1390/10000 [00:10<01:00, 141.54it/s]     14%|#4        | 1405/10000 [00:10<01:01, 140.75it/s]     14%|#4        | 1420/10000 [00:10<01:00, 141.19it/s]     14%|#4        | 1435/10000 [00:10<01:00, 141.50it/s]     14%|#4        | 1450/10000 [00:10<01:00, 141.73it/s]     15%|#4        | 1465/10000 [00:11<01:00, 141.90it/s]     15%|#4        | 1480/10000 [00:11<01:00, 141.97it/s]     15%|#4        | 1495/10000 [00:11<00:59, 142.10it/s]     15%|#5        | 1510/10000 [00:11<00:59, 142.15it/s]     15%|#5        | 1525/10000 [00:11<00:59, 142.17it/s]     15%|#5        | 1540/10000 [00:11<00:59, 142.21it/s]     16%|#5        | 1555/10000 [00:11<00:59, 142.24it/s]     16%|#5        | 1570/10000 [00:11<00:59, 142.19it/s]     16%|#5        | 1585/10000 [00:11<00:59, 142.18it/s]     16%|#6        | 1600/10000 [00:11<00:59, 141.39it/s]     16%|#6        | 1615/10000 [00:12<00:59, 141.65it/s]     16%|#6        | 1630/10000 [00:12<00:59, 141.75it/s]     16%|#6        | 1645/10000 [00:12<00:58, 141.92it/s]     17%|#6        | 1660/10000 [00:12<00:58, 141.98it/s]     17%|#6        | 1675/10000 [00:12<00:58, 141.77it/s]     17%|#6        | 1690/10000 [00:12<00:58, 141.73it/s]     17%|#7        | 1705/10000 [00:12<00:58, 141.87it/s]     17%|#7        | 1720/10000 [00:12<00:59, 139.69it/s]     17%|#7        | 1735/10000 [00:12<00:58, 140.33it/s]     18%|#7        | 1750/10000 [00:13<00:58, 140.89it/s]     18%|#7        | 1765/10000 [00:13<00:58, 140.38it/s]     18%|#7        | 1780/10000 [00:13<00:58, 140.80it/s]     18%|#7        | 1795/10000 [00:13<00:58, 141.18it/s]     18%|#8        | 1810/10000 [00:13<00:57, 141.49it/s]     18%|#8        | 1825/10000 [00:13<00:57, 141.55it/s]     18%|#8        | 1840/10000 [00:13<00:57, 141.75it/s]     19%|#8        | 1855/10000 [00:13<00:57, 141.84it/s]     19%|#8        | 1870/10000 [00:13<00:57, 141.96it/s]     19%|#8        | 1885/10000 [00:13<00:57, 142.05it/s]     19%|#9        | 1900/10000 [00:14<00:56, 142.16it/s]     19%|#9        | 1915/10000 [00:14<00:56, 142.17it/s]     19%|#9        | 1930/10000 [00:14<00:56, 142.19it/s]     19%|#9        | 1945/10000 [00:14<00:56, 142.08it/s]     20%|#9        | 1960/10000 [00:14<00:56, 142.12it/s]     20%|#9        | 1975/10000 [00:14<00:56, 142.12it/s]     20%|#9        | 1990/10000 [00:14<00:56, 142.15it/s]     20%|##        | 2005/10000 [00:14<00:56, 142.02it/s]     20%|##        | 2020/10000 [00:14<00:56, 142.06it/s]     20%|##        | 2035/10000 [00:15<00:56, 142.14it/s]     20%|##        | 2050/10000 [00:15<00:55, 142.17it/s]     21%|##        | 2065/10000 [00:15<00:55, 142.13it/s]     21%|##        | 2080/10000 [00:15<00:55, 142.17it/s]     21%|##        | 2095/10000 [00:15<00:55, 142.07it/s]     21%|##1       | 2110/10000 [00:15<00:55, 142.08it/s]     21%|##1       | 2125/10000 [00:15<00:55, 141.47it/s]     21%|##1       | 2140/10000 [00:15<00:55, 141.71it/s]     22%|##1       | 2155/10000 [00:15<00:55, 141.94it/s]     22%|##1       | 2170/10000 [00:15<00:55, 142.09it/s]     22%|##1       | 2185/10000 [00:16<00:54, 142.17it/s]     22%|##2       | 2200/10000 [00:16<00:54, 142.20it/s]     22%|##2       | 2215/10000 [00:16<00:54, 142.28it/s]     22%|##2       | 2230/10000 [00:16<00:54, 142.33it/s]     22%|##2       | 2245/10000 [00:16<00:54, 141.98it/s]     23%|##2       | 2260/10000 [00:16<00:54, 141.94it/s]     23%|##2       | 2275/10000 [00:16<00:54, 142.09it/s]     23%|##2       | 2290/10000 [00:16<00:54, 142.17it/s]     23%|##3       | 2305/10000 [00:16<00:54, 142.05it/s]     23%|##3       | 2320/10000 [00:17<00:54, 142.11it/s]     23%|##3       | 2335/10000 [00:17<00:53, 142.03it/s]     24%|##3       | 2350/10000 [00:17<00:53, 142.13it/s]     24%|##3       | 2365/10000 [00:17<00:53, 142.07it/s]     24%|##3       | 2380/10000 [00:17<00:53, 142.19it/s]     24%|##3       | 2395/10000 [00:17<00:53, 142.24it/s]     24%|##4       | 2410/10000 [00:17<00:53, 142.24it/s]     24%|##4       | 2425/10000 [00:17<00:56, 133.71it/s]     24%|##4       | 2439/10000 [00:17<00:55, 135.41it/s]     25%|##4       | 2454/10000 [00:18<00:55, 136.97it/s]     25%|##4       | 2469/10000 [00:18<00:54, 137.95it/s]     25%|##4       | 2484/10000 [00:18<00:54, 139.01it/s]     25%|##4       | 2499/10000 [00:18<00:53, 139.67it/s]     25%|##5       | 2514/10000 [00:18<00:53, 139.88it/s]     25%|##5       | 2529/10000 [00:18<00:53, 140.27it/s]     25%|##5       | 2544/10000 [00:18<00:53, 140.58it/s]     26%|##5       | 2559/10000 [00:18<00:53, 139.78it/s]     26%|##5       | 2574/10000 [00:18<00:52, 140.12it/s]     26%|##5       | 2589/10000 [00:18<00:52, 140.31it/s]     26%|##6       | 2604/10000 [00:19<00:52, 140.80it/s]     26%|##6       | 2619/10000 [00:19<00:52, 141.09it/s]     26%|##6       | 2634/10000 [00:19<00:52, 139.42it/s]     26%|##6       | 2649/10000 [00:19<00:52, 140.05it/s]     27%|##6       | 2664/10000 [00:19<00:52, 140.62it/s]     27%|##6       | 2679/10000 [00:19<00:52, 140.09it/s]     27%|##6       | 2694/10000 [00:19<00:52, 140.43it/s]     27%|##7       | 2709/10000 [00:19<00:52, 139.33it/s]     27%|##7       | 2724/10000 [00:19<00:51, 140.04it/s]     27%|##7       | 2739/10000 [00:20<00:51, 140.63it/s]     28%|##7       | 2754/10000 [00:20<00:51, 140.97it/s]     28%|##7       | 2769/10000 [00:20<00:51, 141.35it/s]     28%|##7       | 2784/10000 [00:20<00:50, 141.65it/s]     28%|##7       | 2799/10000 [00:20<00:50, 141.81it/s]     28%|##8       | 2814/10000 [00:20<00:50, 140.97it/s]     28%|##8       | 2829/10000 [00:20<00:50, 141.36it/s]     28%|##8       | 2844/10000 [00:20<00:50, 141.31it/s]     29%|##8       | 2859/10000 [00:20<00:50, 141.33it/s]     29%|##8       | 2874/10000 [00:20<00:50, 141.59it/s]     29%|##8       | 2889/10000 [00:21<00:50, 141.78it/s]     29%|##9       | 2904/10000 [00:21<00:50, 141.78it/s]     29%|##9       | 2919/10000 [00:21<00:49, 141.79it/s]     29%|##9       | 2934/10000 [00:21<00:49, 141.84it/s]     29%|##9       | 2949/10000 [00:21<00:49, 141.92it/s]     30%|##9       | 2964/10000 [00:21<00:49, 141.98it/s]     30%|##9       | 2979/10000 [00:21<00:49, 142.01it/s]     30%|##9       | 2994/10000 [00:21<00:49, 141.62it/s]     30%|###       | 3009/10000 [00:21<00:49, 141.79it/s]     30%|###       | 3024/10000 [00:22<00:49, 141.01it/s]     30%|###       | 3039/10000 [00:22<00:49, 141.27it/s]     31%|###       | 3054/10000 [00:22<00:49, 141.56it/s]     31%|###       | 3069/10000 [00:22<00:48, 141.70it/s]     31%|###       | 3084/10000 [00:22<00:48, 141.87it/s]     31%|###       | 3099/10000 [00:22<00:48, 141.90it/s]     31%|###1      | 3114/10000 [00:22<00:48, 141.68it/s]     31%|###1      | 3129/10000 [00:22<00:48, 141.84it/s]     31%|###1      | 3144/10000 [00:22<00:48, 141.93it/s]     32%|###1      | 3159/10000 [00:22<00:48, 142.03it/s]     32%|###1      | 3174/10000 [00:23<00:48, 142.15it/s]     32%|###1      | 3189/10000 [00:23<00:47, 142.16it/s]     32%|###2      | 3204/10000 [00:23<00:47, 142.19it/s]     32%|###2      | 3219/10000 [00:23<00:47, 142.18it/s]     32%|###2      | 3234/10000 [00:23<00:47, 142.22it/s]     32%|###2      | 3249/10000 [00:23<00:47, 142.29it/s]     33%|###2      | 3264/10000 [00:23<00:48, 140.21it/s]     33%|###2      | 3279/10000 [00:23<00:47, 140.87it/s]     33%|###2      | 3294/10000 [00:23<00:47, 141.27it/s]     33%|###3      | 3309/10000 [00:24<00:47, 141.60it/s]     33%|###3      | 3324/10000 [00:24<00:47, 141.83it/s]     33%|###3      | 3339/10000 [00:24<00:46, 142.01it/s]     34%|###3      | 3354/10000 [00:24<00:46, 142.18it/s]     34%|###3      | 3369/10000 [00:24<00:46, 141.78it/s]     34%|###3      | 3384/10000 [00:24<00:46, 141.97it/s]     34%|###3      | 3399/10000 [00:24<00:46, 141.75it/s]     34%|###4      | 3414/10000 [00:24<00:52, 124.72it/s]     34%|###4      | 3429/10000 [00:24<00:50, 129.43it/s]     34%|###4      | 3444/10000 [00:25<00:49, 132.98it/s]     35%|###4      | 3459/10000 [00:25<00:48, 135.54it/s]     35%|###4      | 3473/10000 [00:25<00:47, 136.50it/s]     35%|###4      | 3488/10000 [00:25<00:47, 137.88it/s]     35%|###5      | 3503/10000 [00:25<00:46, 138.97it/s]     35%|###5      | 3517/10000 [00:25<00:46, 138.99it/s]     35%|###5      | 3532/10000 [00:25<00:46, 139.89it/s]     35%|###5      | 3547/10000 [00:25<00:45, 140.50it/s]     36%|###5      | 3562/10000 [00:25<00:46, 139.42it/s]     36%|###5      | 3577/10000 [00:26<00:45, 139.90it/s]     36%|###5      | 3592/10000 [00:26<00:45, 140.58it/s]     36%|###6      | 3607/10000 [00:26<00:45, 141.05it/s]     36%|###6      | 3622/10000 [00:26<00:45, 141.41it/s]     36%|###6      | 3637/10000 [00:26<00:44, 141.47it/s]     37%|###6      | 3652/10000 [00:26<00:44, 141.68it/s]     37%|###6      | 3667/10000 [00:26<00:44, 141.87it/s]     37%|###6      | 3682/10000 [00:26<00:44, 141.99it/s]     37%|###6      | 3697/10000 [00:26<00:45, 139.73it/s]     37%|###7      | 3712/10000 [00:26<00:44, 140.42it/s]     37%|###7      | 3727/10000 [00:27<00:44, 140.81it/s]     37%|###7      | 3742/10000 [00:27<00:44, 141.22it/s]     38%|###7      | 3757/10000 [00:27<00:44, 141.28it/s]     38%|###7      | 3772/10000 [00:27<00:44, 140.62it/s]     38%|###7      | 3787/10000 [00:27<00:44, 140.56it/s]     38%|###8      | 3802/10000 [00:27<00:44, 140.02it/s]     38%|###8      | 3817/10000 [00:27<00:44, 140.18it/s]     38%|###8      | 3832/10000 [00:27<00:43, 140.69it/s]     38%|###8      | 3847/10000 [00:27<00:44, 138.35it/s]     39%|###8      | 3862/10000 [00:28<00:44, 139.33it/s]     39%|###8      | 3877/10000 [00:28<00:43, 139.91it/s]     39%|###8      | 3892/10000 [00:28<00:43, 139.61it/s]     39%|###9      | 3906/10000 [00:28<00:43, 138.88it/s]     39%|###9      | 3921/10000 [00:28<00:43, 139.67it/s]     39%|###9      | 3936/10000 [00:28<00:43, 140.24it/s]     40%|###9      | 3951/10000 [00:28<00:43, 140.64it/s]     40%|###9      | 3966/10000 [00:28<00:43, 139.87it/s]     40%|###9      | 3981/10000 [00:28<00:42, 140.42it/s]     40%|###9      | 3996/10000 [00:28<00:42, 140.71it/s]     40%|####      | 4011/10000 [00:29<00:42, 139.33it/s]     40%|####      | 4026/10000 [00:29<00:42, 140.10it/s]     40%|####      | 4041/10000 [00:29<00:42, 138.83it/s]     41%|####      | 4056/10000 [00:29<00:42, 139.42it/s]     41%|####      | 4070/10000 [00:29<00:48, 121.95it/s]     41%|####      | 4083/10000 [00:29<00:48, 121.99it/s]     41%|####      | 4097/10000 [00:29<00:46, 126.46it/s]     41%|####1     | 4112/10000 [00:29<00:45, 130.59it/s]     41%|####1     | 4126/10000 [00:29<00:44, 133.13it/s]     41%|####1     | 4140/10000 [00:30<00:43, 135.04it/s]     42%|####1     | 4155/10000 [00:30<00:42, 136.75it/s]     42%|####1     | 4170/10000 [00:30<00:42, 138.18it/s]     42%|####1     | 4185/10000 [00:30<00:41, 139.06it/s]     42%|####1     | 4199/10000 [00:30<00:41, 138.46it/s]     42%|####2     | 4213/10000 [00:30<00:41, 138.11it/s]     42%|####2     | 4228/10000 [00:30<00:41, 137.50it/s]     42%|####2     | 4242/10000 [00:30<00:41, 138.06it/s]     43%|####2     | 4256/10000 [00:30<00:41, 137.18it/s]     43%|####2     | 4270/10000 [00:31<00:41, 137.78it/s]     43%|####2     | 4285/10000 [00:31<00:41, 138.69it/s]     43%|####3     | 4300/10000 [00:31<00:40, 139.33it/s]     43%|####3     | 4315/10000 [00:31<00:40, 139.91it/s]     43%|####3     | 4330/10000 [00:31<00:40, 140.48it/s]     43%|####3     | 4345/10000 [00:31<00:40, 139.31it/s]     44%|####3     | 4360/10000 [00:31<00:40, 139.75it/s]     44%|####3     | 4375/10000 [00:31<00:40, 140.26it/s]     44%|####3     | 4390/10000 [00:31<00:39, 140.43it/s]     44%|####4     | 4405/10000 [00:31<00:39, 140.03it/s]     44%|####4     | 4420/10000 [00:32<00:40, 138.48it/s]     44%|####4     | 4435/10000 [00:32<00:39, 139.41it/s]     44%|####4     | 4449/10000 [00:32<00:42, 130.47it/s]     45%|####4     | 4464/10000 [00:32<00:41, 133.34it/s]     45%|####4     | 4479/10000 [00:32<00:40, 135.61it/s]     45%|####4     | 4493/10000 [00:32<00:40, 134.57it/s]     45%|####5     | 4507/10000 [00:32<00:41, 130.97it/s]     45%|####5     | 4522/10000 [00:32<00:40, 134.07it/s]     45%|####5     | 4537/10000 [00:32<00:40, 136.20it/s]     46%|####5     | 4551/10000 [00:33<00:40, 135.81it/s]     46%|####5     | 4566/10000 [00:33<00:39, 137.53it/s]     46%|####5     | 4581/10000 [00:33<00:39, 138.73it/s]     46%|####5     | 4596/10000 [00:33<00:38, 139.60it/s]     46%|####6     | 4611/10000 [00:33<00:38, 140.15it/s]     46%|####6     | 4626/10000 [00:33<00:38, 140.65it/s]     46%|####6     | 4641/10000 [00:33<00:38, 140.92it/s]     47%|####6     | 4656/10000 [00:33<00:37, 141.21it/s]     47%|####6     | 4671/10000 [00:33<00:37, 141.33it/s]     47%|####6     | 4686/10000 [00:34<00:42, 124.10it/s]     47%|####7     | 4701/10000 [00:34<00:41, 128.64it/s]     47%|####7     | 4716/10000 [00:34<00:39, 132.24it/s]     47%|####7     | 4731/10000 [00:34<00:39, 134.70it/s]     47%|####7     | 4746/10000 [00:34<00:38, 136.74it/s]     48%|####7     | 4761/10000 [00:34<00:37, 138.19it/s]     48%|####7     | 4776/10000 [00:34<00:37, 139.23it/s]     48%|####7     | 4791/10000 [00:34<00:37, 139.90it/s]     48%|####8     | 4806/10000 [00:34<00:37, 140.34it/s]     48%|####8     | 4821/10000 [00:35<00:36, 140.60it/s]     48%|####8     | 4836/10000 [00:35<00:36, 140.91it/s]     49%|####8     | 4851/10000 [00:35<00:36, 141.17it/s]     49%|####8     | 4866/10000 [00:35<00:36, 141.31it/s]     49%|####8     | 4881/10000 [00:35<00:36, 141.36it/s]     49%|####8     | 4896/10000 [00:35<00:36, 141.37it/s]     49%|####9     | 4911/10000 [00:35<00:36, 140.72it/s]     49%|####9     | 4926/10000 [00:35<00:36, 140.44it/s]     49%|####9     | 4941/10000 [00:35<00:36, 140.44it/s]     50%|####9     | 4956/10000 [00:35<00:35, 140.51it/s]     50%|####9     | 4971/10000 [00:36<00:35, 140.38it/s]     50%|####9     | 4986/10000 [00:36<00:35, 140.75it/s]     50%|#####     | 5001/10000 [00:36<00:35, 140.75it/s]     50%|#####     | 5016/10000 [00:36<00:35, 140.93it/s]     50%|#####     | 5031/10000 [00:36<00:36, 134.77it/s]     50%|#####     | 5045/10000 [00:36<00:36, 135.89it/s]     51%|#####     | 5060/10000 [00:36<00:35, 137.56it/s]     51%|#####     | 5075/10000 [00:36<00:35, 138.74it/s]     51%|#####     | 5089/10000 [00:36<00:35, 137.96it/s]     51%|#####1    | 5104/10000 [00:37<00:35, 139.00it/s]     51%|#####1    | 5118/10000 [00:37<00:35, 137.30it/s]     51%|#####1    | 5133/10000 [00:37<00:35, 138.40it/s]     51%|#####1    | 5148/10000 [00:37<00:34, 139.38it/s]     52%|#####1    | 5162/10000 [00:37<00:37, 130.75it/s]     52%|#####1    | 5176/10000 [00:37<00:38, 125.01it/s]     52%|#####1    | 5190/10000 [00:37<00:37, 127.48it/s]     52%|#####2    | 5203/10000 [00:37<00:38, 125.95it/s]     52%|#####2    | 5218/10000 [00:37<00:36, 130.13it/s]     52%|#####2    | 5233/10000 [00:38<00:35, 133.41it/s]     52%|#####2    | 5247/10000 [00:38<00:35, 133.84it/s]     53%|#####2    | 5262/10000 [00:38<00:34, 136.06it/s]     53%|#####2    | 5276/10000 [00:38<00:34, 137.17it/s]     53%|#####2    | 5290/10000 [00:38<00:37, 125.73it/s]     53%|#####3    | 5304/10000 [00:38<00:36, 127.51it/s]     53%|#####3    | 5319/10000 [00:38<00:35, 131.46it/s]     53%|#####3    | 5334/10000 [00:38<00:34, 134.35it/s]     53%|#####3    | 5348/10000 [00:38<00:34, 135.09it/s]     54%|#####3    | 5363/10000 [00:39<00:33, 136.64it/s]     54%|#####3    | 5378/10000 [00:39<00:33, 138.10it/s]     54%|#####3    | 5393/10000 [00:39<00:33, 139.08it/s]     54%|#####4    | 5407/10000 [00:39<00:33, 135.73it/s]     54%|#####4    | 5421/10000 [00:39<00:33, 136.79it/s]     54%|#####4    | 5436/10000 [00:39<00:33, 138.26it/s]     55%|#####4    | 5451/10000 [00:39<00:32, 139.25it/s]     55%|#####4    | 5466/10000 [00:39<00:32, 139.58it/s]     55%|#####4    | 5481/10000 [00:39<00:32, 140.05it/s]     55%|#####4    | 5496/10000 [00:39<00:32, 138.73it/s]     55%|#####5    | 5511/10000 [00:40<00:32, 139.51it/s]     55%|#####5    | 5526/10000 [00:40<00:31, 140.05it/s]     55%|#####5    | 5541/10000 [00:40<00:31, 140.50it/s]     56%|#####5    | 5556/10000 [00:40<00:31, 140.87it/s]     56%|#####5    | 5571/10000 [00:40<00:31, 141.11it/s]     56%|#####5    | 5586/10000 [00:40<00:31, 140.08it/s]     56%|#####6    | 5601/10000 [00:40<00:31, 140.54it/s]     56%|#####6    | 5616/10000 [00:40<00:32, 133.56it/s]     56%|#####6    | 5630/10000 [00:41<00:38, 113.92it/s]     56%|#####6    | 5645/10000 [00:41<00:35, 121.16it/s]     57%|#####6    | 5660/10000 [00:41<00:34, 126.74it/s]     57%|#####6    | 5674/10000 [00:41<00:33, 128.69it/s]     57%|#####6    | 5689/10000 [00:41<00:32, 132.45it/s]     57%|#####7    | 5704/10000 [00:41<00:31, 135.13it/s]     57%|#####7    | 5719/10000 [00:41<00:31, 137.11it/s]     57%|#####7    | 5734/10000 [00:41<00:30, 138.46it/s]     57%|#####7    | 5749/10000 [00:41<00:30, 139.45it/s]     58%|#####7    | 5764/10000 [00:41<00:30, 138.79it/s]     58%|#####7    | 5779/10000 [00:42<00:30, 139.63it/s]     58%|#####7    | 5794/10000 [00:42<00:30, 140.05it/s]     58%|#####8    | 5809/10000 [00:42<00:29, 140.14it/s]     58%|#####8    | 5824/10000 [00:42<00:30, 137.06it/s]     58%|#####8    | 5838/10000 [00:42<00:31, 132.89it/s]     59%|#####8    | 5852/10000 [00:42<00:30, 134.76it/s]     59%|#####8    | 5867/10000 [00:42<00:30, 136.69it/s]     59%|#####8    | 5882/10000 [00:42<00:29, 138.25it/s]     59%|#####8    | 5896/10000 [00:42<00:30, 133.65it/s]     59%|#####9    | 5911/10000 [00:43<00:30, 135.99it/s]     59%|#####9    | 5926/10000 [00:43<00:29, 137.71it/s]     59%|#####9    | 5940/10000 [00:43<00:29, 137.07it/s]     60%|#####9    | 5955/10000 [00:43<00:29, 138.22it/s]     60%|#####9    | 5970/10000 [00:43<00:28, 139.07it/s]     60%|#####9    | 5984/10000 [00:43<00:29, 137.42it/s]     60%|#####9    | 5999/10000 [00:43<00:28, 138.79it/s]     60%|######    | 6014/10000 [00:43<00:28, 139.72it/s]     60%|######    | 6029/10000 [00:43<00:28, 140.02it/s]     60%|######    | 6044/10000 [00:43<00:28, 140.60it/s]     61%|######    | 6059/10000 [00:44<00:27, 141.05it/s]     61%|######    | 6074/10000 [00:44<00:27, 141.31it/s]     61%|######    | 6089/10000 [00:44<00:27, 141.52it/s]     61%|######1   | 6104/10000 [00:44<00:27, 141.68it/s]     61%|######1   | 6119/10000 [00:44<00:27, 141.82it/s]     61%|######1   | 6134/10000 [00:44<00:27, 141.16it/s]     61%|######1   | 6149/10000 [00:44<00:27, 141.39it/s]     62%|######1   | 6164/10000 [00:44<00:27, 139.21it/s]     62%|######1   | 6179/10000 [00:44<00:27, 139.97it/s]     62%|######1   | 6194/10000 [00:45<00:27, 140.56it/s]     62%|######2   | 6209/10000 [00:45<00:26, 140.95it/s]     62%|######2   | 6224/10000 [00:45<00:26, 141.24it/s]     62%|######2   | 6239/10000 [00:45<00:26, 140.96it/s]     63%|######2   | 6254/10000 [00:45<00:26, 141.24it/s]     63%|######2   | 6269/10000 [00:45<00:26, 140.44it/s]     63%|######2   | 6284/10000 [00:45<00:26, 140.48it/s]     63%|######2   | 6299/10000 [00:45<00:26, 139.43it/s]     63%|######3   | 6314/10000 [00:45<00:26, 140.08it/s]     63%|######3   | 6329/10000 [00:46<00:26, 140.65it/s]     63%|######3   | 6344/10000 [00:46<00:25, 141.06it/s]     64%|######3   | 6359/10000 [00:46<00:25, 141.27it/s]     64%|######3   | 6374/10000 [00:46<00:25, 141.51it/s]     64%|######3   | 6389/10000 [00:46<00:25, 141.62it/s]     64%|######4   | 6404/10000 [00:46<00:25, 141.42it/s]     64%|######4   | 6419/10000 [00:46<00:25, 141.48it/s]     64%|######4   | 6434/10000 [00:46<00:25, 141.39it/s]     64%|######4   | 6449/10000 [00:46<00:25, 141.58it/s]     65%|######4   | 6464/10000 [00:46<00:24, 141.65it/s]     65%|######4   | 6479/10000 [00:47<00:24, 141.74it/s]     65%|######4   | 6494/10000 [00:47<00:24, 141.75it/s]     65%|######5   | 6509/10000 [00:47<00:24, 141.78it/s]     65%|######5   | 6524/10000 [00:47<00:24, 141.81it/s]     65%|######5   | 6539/10000 [00:47<00:24, 141.88it/s]     66%|######5   | 6554/10000 [00:47<00:24, 141.91it/s]     66%|######5   | 6569/10000 [00:47<00:24, 141.88it/s]     66%|######5   | 6584/10000 [00:47<00:24, 141.82it/s]     66%|######5   | 6599/10000 [00:47<00:24, 141.48it/s]     66%|######6   | 6614/10000 [00:48<00:23, 141.63it/s]     66%|######6   | 6629/10000 [00:48<00:23, 141.69it/s]     66%|######6   | 6644/10000 [00:48<00:23, 141.05it/s]     67%|######6   | 6659/10000 [00:48<00:23, 141.34it/s]     67%|######6   | 6674/10000 [00:48<00:23, 141.50it/s]     67%|######6   | 6689/10000 [00:48<00:23, 141.66it/s]     67%|######7   | 6704/10000 [00:48<00:23, 141.60it/s]     67%|######7   | 6719/10000 [00:48<00:23, 140.83it/s]     67%|######7   | 6734/10000 [00:48<00:23, 138.90it/s]     67%|######7   | 6749/10000 [00:48<00:23, 139.71it/s]     68%|######7   | 6764/10000 [00:49<00:23, 140.35it/s]     68%|######7   | 6779/10000 [00:49<00:22, 140.79it/s]     68%|######7   | 6794/10000 [00:49<00:22, 140.86it/s]     68%|######8   | 6809/10000 [00:49<00:22, 141.06it/s]     68%|######8   | 6824/10000 [00:49<00:22, 141.19it/s]     68%|######8   | 6839/10000 [00:49<00:22, 141.26it/s]     69%|######8   | 6854/10000 [00:49<00:22, 139.89it/s]     69%|######8   | 6869/10000 [00:49<00:22, 140.47it/s]     69%|######8   | 6884/10000 [00:49<00:22, 140.87it/s]     69%|######8   | 6899/10000 [00:50<00:22, 139.60it/s]     69%|######9   | 6913/10000 [00:50<00:22, 139.30it/s]     69%|######9   | 6927/10000 [00:50<00:22, 139.23it/s]     69%|######9   | 6942/10000 [00:50<00:21, 139.69it/s]     70%|######9   | 6956/10000 [00:50<00:24, 126.72it/s]     70%|######9   | 6970/10000 [00:50<00:23, 129.75it/s]     70%|######9   | 6985/10000 [00:50<00:22, 133.19it/s]     70%|#######   | 7000/10000 [00:50<00:22, 135.68it/s]     70%|#######   | 7015/10000 [00:50<00:21, 137.45it/s]     70%|#######   | 7029/10000 [00:51<00:21, 138.05it/s]     70%|#######   | 7044/10000 [00:51<00:21, 139.02it/s]     71%|#######   | 7059/10000 [00:51<00:21, 139.86it/s]     71%|#######   | 7074/10000 [00:51<00:20, 140.47it/s]     71%|#######   | 7089/10000 [00:51<00:23, 124.29it/s]     71%|#######1  | 7104/10000 [00:51<00:22, 129.03it/s]     71%|#######1  | 7119/10000 [00:51<00:21, 132.54it/s]     71%|#######1  | 7133/10000 [00:51<00:21, 134.22it/s]     71%|#######1  | 7148/10000 [00:51<00:20, 136.17it/s]     72%|#######1  | 7162/10000 [00:52<00:20, 136.83it/s]     72%|#######1  | 7177/10000 [00:52<00:20, 138.19it/s]     72%|#######1  | 7192/10000 [00:52<00:20, 139.17it/s]     72%|#######2  | 7207/10000 [00:52<00:19, 139.77it/s]     72%|#######2  | 7222/10000 [00:52<00:19, 140.11it/s]     72%|#######2  | 7237/10000 [00:52<00:19, 139.04it/s]     73%|#######2  | 7252/10000 [00:52<00:19, 139.62it/s]     73%|#######2  | 7267/10000 [00:52<00:19, 140.07it/s]     73%|#######2  | 7282/10000 [00:52<00:19, 140.42it/s]     73%|#######2  | 7297/10000 [00:52<00:19, 140.61it/s]     73%|#######3  | 7312/10000 [00:53<00:19, 140.79it/s]     73%|#######3  | 7327/10000 [00:53<00:18, 140.81it/s]     73%|#######3  | 7342/10000 [00:53<00:20, 126.83it/s]     74%|#######3  | 7357/10000 [00:53<00:20, 130.75it/s]     74%|#######3  | 7372/10000 [00:53<00:19, 133.66it/s]     74%|#######3  | 7387/10000 [00:53<00:19, 135.83it/s]     74%|#######4  | 7402/10000 [00:53<00:18, 137.33it/s]     74%|#######4  | 7417/10000 [00:53<00:18, 138.31it/s]     74%|#######4  | 7432/10000 [00:53<00:18, 139.03it/s]     74%|#######4  | 7447/10000 [00:54<00:18, 139.54it/s]     75%|#######4  | 7462/10000 [00:54<00:18, 139.93it/s]     75%|#######4  | 7477/10000 [00:54<00:17, 140.23it/s]     75%|#######4  | 7492/10000 [00:54<00:17, 140.18it/s]     75%|#######5  | 7507/10000 [00:54<00:17, 140.31it/s]     75%|#######5  | 7522/10000 [00:54<00:17, 140.55it/s]     75%|#######5  | 7537/10000 [00:54<00:17, 139.50it/s]     76%|#######5  | 7552/10000 [00:54<00:17, 139.98it/s]     76%|#######5  | 7567/10000 [00:54<00:17, 140.35it/s]     76%|#######5  | 7582/10000 [00:55<00:18, 132.85it/s]     76%|#######5  | 7596/10000 [00:55<00:18, 129.82it/s]     76%|#######6  | 7611/10000 [00:55<00:17, 132.96it/s]     76%|#######6  | 7626/10000 [00:55<00:17, 135.23it/s]     76%|#######6  | 7641/10000 [00:55<00:17, 136.91it/s]     77%|#######6  | 7655/10000 [00:55<00:17, 136.98it/s]     77%|#######6  | 7670/10000 [00:55<00:16, 138.20it/s]     77%|#######6  | 7685/10000 [00:55<00:16, 139.05it/s]     77%|#######6  | 7699/10000 [00:55<00:16, 138.97it/s]     77%|#######7  | 7714/10000 [00:56<00:16, 139.57it/s]     77%|#######7  | 7728/10000 [00:56<00:18, 125.71it/s]     77%|#######7  | 7743/10000 [00:56<00:17, 130.09it/s]     78%|#######7  | 7758/10000 [00:56<00:16, 133.26it/s]     78%|#######7  | 7773/10000 [00:56<00:16, 135.54it/s]     78%|#######7  | 7788/10000 [00:56<00:16, 136.86it/s]     78%|#######8  | 7803/10000 [00:56<00:15, 138.11it/s]     78%|#######8  | 7818/10000 [00:56<00:15, 139.00it/s]     78%|#######8  | 7833/10000 [00:56<00:15, 139.59it/s]     78%|#######8  | 7848/10000 [00:57<00:15, 140.00it/s]     79%|#######8  | 7863/10000 [00:57<00:15, 139.26it/s]     79%|#######8  | 7878/10000 [00:57<00:15, 139.70it/s]     79%|#######8  | 7893/10000 [00:57<00:15, 140.19it/s]     79%|#######9  | 7908/10000 [00:57<00:14, 140.52it/s]     79%|#######9  | 7923/10000 [00:57<00:14, 140.59it/s]     79%|#######9  | 7938/10000 [00:57<00:14, 140.72it/s]     80%|#######9  | 7953/10000 [00:57<00:14, 140.73it/s]     80%|#######9  | 7968/10000 [00:57<00:14, 138.52it/s]     80%|#######9  | 7983/10000 [00:57<00:14, 138.99it/s]     80%|#######9  | 7997/10000 [00:58<00:14, 138.52it/s]     80%|########  | 8011/10000 [00:58<00:14, 138.93it/s]     80%|########  | 8026/10000 [00:58<00:14, 139.59it/s]     80%|########  | 8041/10000 [00:58<00:13, 140.10it/s]     81%|########  | 8056/10000 [00:58<00:13, 140.32it/s]     81%|########  | 8071/10000 [00:58<00:13, 140.41it/s]     81%|########  | 8086/10000 [00:58<00:13, 140.66it/s]     81%|########1 | 8101/10000 [00:58<00:13, 138.98it/s]     81%|########1 | 8116/10000 [00:58<00:13, 139.53it/s]     81%|########1 | 8131/10000 [00:59<00:13, 139.99it/s]     81%|########1 | 8146/10000 [00:59<00:13, 140.24it/s]     82%|########1 | 8161/10000 [00:59<00:13, 139.03it/s]     82%|########1 | 8176/10000 [00:59<00:13, 139.63it/s]     82%|########1 | 8190/10000 [00:59<00:13, 138.36it/s]     82%|########2 | 8205/10000 [00:59<00:12, 139.13it/s]     82%|########2 | 8220/10000 [00:59<00:12, 139.78it/s]     82%|########2 | 8234/10000 [00:59<00:14, 123.68it/s]     82%|########2 | 8247/10000 [00:59<00:16, 103.74it/s]     83%|########2 | 8261/10000 [01:00<00:15, 111.01it/s]     83%|########2 | 8276/10000 [01:00<00:14, 118.93it/s]     83%|########2 | 8291/10000 [01:00<00:13, 124.95it/s]     83%|########3 | 8306/10000 [01:00<00:13, 129.55it/s]     83%|########3 | 8320/10000 [01:00<00:12, 132.23it/s]     83%|########3 | 8334/10000 [01:00<00:12, 133.65it/s]     83%|########3 | 8349/10000 [01:00<00:12, 135.97it/s]     84%|########3 | 8363/10000 [01:00<00:12, 133.90it/s]     84%|########3 | 8377/10000 [01:00<00:12, 133.81it/s]     84%|########3 | 8392/10000 [01:01<00:11, 135.70it/s]     84%|########4 | 8407/10000 [01:01<00:11, 137.26it/s]     84%|########4 | 8422/10000 [01:01<00:11, 138.37it/s]     84%|########4 | 8436/10000 [01:01<00:11, 138.47it/s]     85%|########4 | 8451/10000 [01:01<00:11, 139.24it/s]     85%|########4 | 8465/10000 [01:01<00:11, 135.82it/s]     85%|########4 | 8479/10000 [01:01<00:11, 136.10it/s]     85%|########4 | 8493/10000 [01:01<00:11, 135.31it/s]     85%|########5 | 8507/10000 [01:01<00:10, 136.61it/s]     85%|########5 | 8521/10000 [01:02<00:11, 128.46it/s]     85%|########5 | 8535/10000 [01:02<00:11, 131.05it/s]     85%|########5 | 8549/10000 [01:02<00:10, 133.44it/s]     86%|########5 | 8563/10000 [01:02<00:10, 132.40it/s]     86%|########5 | 8577/10000 [01:02<00:13, 109.33it/s]     86%|########5 | 8591/10000 [01:02<00:12, 116.30it/s]     86%|########6 | 8605/10000 [01:02<00:11, 122.26it/s]     86%|########6 | 8619/10000 [01:02<00:11, 124.87it/s]     86%|########6 | 8633/10000 [01:02<00:10, 127.71it/s]     86%|########6 | 8647/10000 [01:03<00:10, 128.86it/s]     87%|########6 | 8661/10000 [01:03<00:10, 129.67it/s]     87%|########6 | 8676/10000 [01:03<00:09, 132.85it/s]     87%|########6 | 8691/10000 [01:03<00:09, 135.17it/s]     87%|########7 | 8705/10000 [01:03<00:09, 136.40it/s]     87%|########7 | 8720/10000 [01:03<00:09, 137.80it/s]     87%|########7 | 8735/10000 [01:03<00:09, 138.77it/s]     87%|########7 | 8749/10000 [01:03<00:09, 132.93it/s]     88%|########7 | 8763/10000 [01:03<00:09, 124.63it/s]     88%|########7 | 8778/10000 [01:04<00:09, 129.16it/s]     88%|########7 | 8792/10000 [01:04<00:11, 107.18it/s]     88%|########8 | 8807/10000 [01:04<00:10, 115.62it/s]     88%|########8 | 8822/10000 [01:04<00:09, 122.34it/s]     88%|########8 | 8837/10000 [01:04<00:09, 127.46it/s]     89%|########8 | 8852/10000 [01:04<00:08, 131.26it/s]     89%|########8 | 8867/10000 [01:04<00:08, 134.05it/s]     89%|########8 | 8881/10000 [01:04<00:08, 135.07it/s]     89%|########8 | 8895/10000 [01:05<00:10, 109.65it/s]     89%|########9 | 8909/10000 [01:05<00:09, 115.92it/s]     89%|########9 | 8923/10000 [01:05<00:08, 122.11it/s]     89%|########9 | 8937/10000 [01:05<00:08, 122.32it/s]     90%|########9 | 8952/10000 [01:05<00:08, 127.47it/s]     90%|########9 | 8967/10000 [01:05<00:07, 131.30it/s]     90%|########9 | 8981/10000 [01:05<00:07, 132.80it/s]     90%|########9 | 8995/10000 [01:05<00:07, 132.76it/s]     90%|######### | 9009/10000 [01:05<00:07, 134.24it/s]     90%|######### | 9023/10000 [01:05<00:07, 132.69it/s]     90%|######### | 9037/10000 [01:06<00:07, 134.61it/s]     91%|######### | 9051/10000 [01:06<00:07, 130.13it/s]     91%|######### | 9066/10000 [01:06<00:07, 133.29it/s]     91%|######### | 9080/10000 [01:06<00:07, 120.72it/s]     91%|######### | 9094/10000 [01:06<00:07, 125.44it/s]     91%|#########1| 9108/10000 [01:06<00:06, 129.01it/s]     91%|#########1| 9122/10000 [01:06<00:06, 131.72it/s]     91%|#########1| 9136/10000 [01:06<00:06, 133.68it/s]     92%|#########1| 9150/10000 [01:06<00:06, 135.14it/s]     92%|#########1| 9164/10000 [01:07<00:06, 136.53it/s]     92%|#########1| 9178/10000 [01:07<00:05, 137.33it/s]     92%|#########1| 9193/10000 [01:07<00:05, 138.34it/s]     92%|#########2| 9208/10000 [01:07<00:05, 139.04it/s]     92%|#########2| 9222/10000 [01:07<00:05, 136.65it/s]     92%|#########2| 9237/10000 [01:07<00:05, 137.93it/s]     93%|#########2| 9252/10000 [01:07<00:05, 138.77it/s]     93%|#########2| 9267/10000 [01:07<00:05, 139.40it/s]     93%|#########2| 9282/10000 [01:07<00:05, 139.84it/s]     93%|#########2| 9296/10000 [01:07<00:05, 139.79it/s]     93%|#########3| 9311/10000 [01:08<00:04, 140.17it/s]     93%|#########3| 9326/10000 [01:08<00:04, 137.41it/s]     93%|#########3| 9340/10000 [01:08<00:04, 137.36it/s]     94%|#########3| 9354/10000 [01:08<00:04, 137.81it/s]     94%|#########3| 9368/10000 [01:08<00:04, 138.35it/s]     94%|#########3| 9382/10000 [01:08<00:04, 138.70it/s]     94%|#########3| 9397/10000 [01:08<00:04, 139.17it/s]     94%|#########4| 9411/10000 [01:08<00:04, 138.77it/s]     94%|#########4| 9426/10000 [01:08<00:04, 139.27it/s]     94%|#########4| 9441/10000 [01:09<00:04, 139.64it/s]     95%|#########4| 9456/10000 [01:09<00:03, 139.94it/s]     95%|#########4| 9470/10000 [01:09<00:04, 124.56it/s]     95%|#########4| 9484/10000 [01:09<00:04, 128.63it/s]     95%|#########4| 9498/10000 [01:09<00:03, 128.79it/s]     95%|#########5| 9512/10000 [01:09<00:04, 118.27it/s]     95%|#########5| 9527/10000 [01:09<00:03, 124.32it/s]     95%|#########5| 9542/10000 [01:09<00:03, 128.98it/s]     96%|#########5| 9557/10000 [01:09<00:03, 132.33it/s]     96%|#########5| 9571/10000 [01:10<00:03, 134.32it/s]     96%|#########5| 9585/10000 [01:10<00:03, 135.29it/s]     96%|#########5| 9599/10000 [01:10<00:02, 135.59it/s]     96%|#########6| 9614/10000 [01:10<00:02, 137.07it/s]     96%|#########6| 9628/10000 [01:10<00:02, 137.88it/s]     96%|#########6| 9643/10000 [01:10<00:02, 138.84it/s]     97%|#########6| 9657/10000 [01:10<00:02, 124.50it/s]     97%|#########6| 9671/10000 [01:10<00:02, 128.63it/s]     97%|#########6| 9686/10000 [01:10<00:02, 132.09it/s]     97%|#########7| 9700/10000 [01:11<00:02, 130.79it/s]     97%|#########7| 9715/10000 [01:11<00:02, 133.62it/s]     97%|#########7| 9730/10000 [01:11<00:01, 135.65it/s]     97%|#########7| 9745/10000 [01:11<00:01, 137.12it/s]     98%|#########7| 9759/10000 [01:11<00:01, 137.92it/s]     98%|#########7| 9774/10000 [01:11<00:01, 138.75it/s]     98%|#########7| 9788/10000 [01:11<00:01, 139.05it/s]     98%|#########8| 9803/10000 [01:11<00:01, 139.49it/s]     98%|#########8| 9817/10000 [01:11<00:01, 139.60it/s]     98%|#########8| 9832/10000 [01:11<00:01, 139.77it/s]     98%|#########8| 9846/10000 [01:12<00:01, 139.82it/s]     99%|#########8| 9861/10000 [01:12<00:00, 139.93it/s]     99%|#########8| 9876/10000 [01:12<00:00, 140.00it/s]     99%|#########8| 9891/10000 [01:12<00:00, 135.61it/s]     99%|#########9| 9905/10000 [01:12<00:00, 136.48it/s]     99%|#########9| 9919/10000 [01:12<00:00, 136.76it/s]     99%|#########9| 9933/10000 [01:12<00:00, 126.11it/s]     99%|#########9| 9946/10000 [01:12<00:00, 118.05it/s]    100%|#########9| 9961/10000 [01:12<00:00, 124.59it/s]    100%|#########9| 9976/10000 [01:13<00:00, 129.34it/s]    100%|#########9| 9991/10000 [01:13<00:00, 132.81it/s]    100%|##########| 10000/10000 [01:13<00:00, 136.55it/s]
    The inversion result from `emcee`:
    ============================
    Summary for inversion result
    ============================
    SUCCESS
    ----------------------------
    sampler: <emcee.ensemble.EnsembleSampler object>
    blob_names: ['log_likelihood', 'log_prior']




.. GENERATED FROM PYTHON SOURCE LINES 725-736

Post-sampling analysis
~~~~~~~~~~~~~~~~~~~~~~

By default the raw sampler resulting object is attached to ``cofi``\ ’s
inversion result.

Optionally, you can convert that into an ``arviz`` data structure to
have access to a range of analysis functions. (See more details in
`arviz
documentation <https://python.arviz.org/en/latest/index.html>`__).


.. GENERATED FROM PYTHON SOURCE LINES 736-745

.. code-block:: default


    import arviz as az

    labels = ["m0", "m1", "m2","m3","m4"]

    sampler = inv_result_3.sampler
    az_idata = az.from_emcee(sampler, var_names=labels)
    # az_idata = inv_result_3.to_arviz()      # alternatively








.. GENERATED FROM PYTHON SOURCE LINES 747-750

.. code-block:: default


    az_idata.get("posterior")






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme=dark],
    body[data-theme=dark],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1F1F1F;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 20px 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: none;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: '►';
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: '▼';
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: '(';
    }

    .xr-dim-list:after {
      content: ')';
    }

    .xr-dim-list li:not(:last-child):after {
      content: ',';
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2 {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
    Dimensions:  (chain: 32, draw: 10000)
    Coordinates:
      * chain    (chain) int64 0 1 2 3 4 5 6 7 8 9 ... 22 23 24 25 26 27 28 29 30 31
      * draw     (draw) int64 0 1 2 3 4 5 6 7 ... 9993 9994 9995 9996 9997 9998 9999
    Data variables:
        m0       (chain, draw) float64 0.0001265 0.0001265 0.0001265 ... 1.741 1.734
        m1       (chain, draw) float64 0.0001205 0.0001205 ... -3.484 -3.479
        m2       (chain, draw) float64 -3.189e-05 -3.189e-05 ... 1.515 1.514
        m3       (chain, draw) float64 6.943e-05 6.943e-05 ... -0.2184 -0.2183
        m4       (chain, draw) float64 -9.607e-05 -9.607e-05 ... 0.006821 0.006819
    Attributes:
        created_at:                 2022-11-24T04:32:41.741514
        arviz_version:              0.12.1
        inference_library:          emcee
        inference_library_version:  3.1.2</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e4aeae58-e82a-4739-b14e-be3db651e306' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e4aeae58-e82a-4739-b14e-be3db651e306' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>chain</span>: 32</li><li><span class='xr-has-index'>draw</span>: 10000</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-82832e20-6879-432e-a121-2a72abc61ae3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-82832e20-6879-432e-a121-2a72abc61ae3' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>chain</span></div><div class='xr-var-dims'>(chain)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 26 27 28 29 30 31</div><input id='attrs-1dc007fb-cf52-46ec-a631-69bebf73e659' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1dc007fb-cf52-46ec-a631-69bebf73e659' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9954847a-b2c7-4dc8-80dd-0563ebe3a787' class='xr-var-data-in' type='checkbox'><label for='data-9954847a-b2c7-4dc8-80dd-0563ebe3a787' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
           18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>draw</span></div><div class='xr-var-dims'>(draw)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 ... 9996 9997 9998 9999</div><input id='attrs-096ea58e-45a7-4694-97e2-91e09d1c3cd8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-096ea58e-45a7-4694-97e2-91e09d1c3cd8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ee8c8eda-18e9-4359-969f-3af5b819c0ea' class='xr-var-data-in' type='checkbox'><label for='data-ee8c8eda-18e9-4359-969f-3af5b819c0ea' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([   0,    1,    2, ..., 9997, 9998, 9999])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d99f2c0a-e67f-401b-9468-a18291dd097f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d99f2c0a-e67f-401b-9468-a18291dd097f' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>m0</span></div><div class='xr-var-dims'>(chain, draw)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0001265 0.0001265 ... 1.741 1.734</div><input id='attrs-a8297447-f5b5-409c-8578-8be376997521' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a8297447-f5b5-409c-8578-8be376997521' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-362a7cf1-6d49-483e-8d30-56fc2dff2199' class='xr-var-data-in' type='checkbox'><label for='data-362a7cf1-6d49-483e-8d30-56fc2dff2199' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 1.26477142e-04,  1.26477142e-04,  1.26477142e-04, ...,
             1.15385334e+00,  1.15385334e+00,  1.15385334e+00],
           [-5.49196078e-08, -5.49196078e-08,  8.60128825e-05, ...,
             1.39126857e+00,  1.20552865e+00,  1.20552865e+00],
           [ 1.26034154e-04,  2.75434876e-04,  2.75434876e-04, ...,
             1.59136775e+00,  1.59136775e+00,  1.59136775e+00],
           ...,
           [ 4.92415081e-05,  4.92415081e-05,  9.49140544e-05, ...,
             1.29770580e+00,  1.29770580e+00,  1.32287427e+00],
           [-2.52516222e-04, -2.52516222e-04, -4.47779433e-04, ...,
             1.35541762e+00,  1.35541762e+00,  1.32598999e+00],
           [-3.84985272e-06, -3.84985272e-06,  4.70307234e-05, ...,
             1.53535653e+00,  1.74112924e+00,  1.73371389e+00]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>m1</span></div><div class='xr-var-dims'>(chain, draw)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0001205 0.0001205 ... -3.479</div><input id='attrs-213882e7-b97a-409e-95ec-54ff5bc81b72' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-213882e7-b97a-409e-95ec-54ff5bc81b72' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0fb20f13-96e4-4e09-92f5-3df1bae74cca' class='xr-var-data-in' type='checkbox'><label for='data-0fb20f13-96e4-4e09-92f5-3df1bae74cca' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 1.20477189e-04,  1.20477189e-04,  1.20477189e-04, ...,
            -2.93357953e+00, -2.93357953e+00, -2.93357953e+00],
           [ 7.38459408e-05,  7.38459408e-05,  1.03805313e-05, ...,
            -3.17890982e+00, -2.99268264e+00, -2.99268264e+00],
           [-1.37332162e-04, -2.42195552e-04, -2.42195552e-04, ...,
            -3.44263702e+00, -3.44263702e+00, -3.44263702e+00],
           ...,
           [ 6.03925531e-05,  6.03925531e-05,  3.29359197e-05, ...,
            -2.78043447e+00, -2.78043447e+00, -2.75364018e+00],
           [-7.36215974e-05, -7.36215974e-05, -1.15444272e-04, ...,
            -3.14314494e+00, -3.14314494e+00, -3.09405247e+00],
           [ 1.84333271e-05,  1.84333271e-05,  3.57638120e-05, ...,
            -3.29103471e+00, -3.48383656e+00, -3.47869796e+00]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>m2</span></div><div class='xr-var-dims'>(chain, draw)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-3.189e-05 -3.189e-05 ... 1.514</div><input id='attrs-39259c9f-3b70-4c88-a492-5da23ccb7d5a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-39259c9f-3b70-4c88-a492-5da23ccb7d5a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5826863b-4007-4779-9022-aa8388f8984a' class='xr-var-data-in' type='checkbox'><label for='data-5826863b-4007-4779-9022-aa8388f8984a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-3.18874540e-05, -3.18874540e-05, -3.18874540e-05, ...,
             1.40088260e+00,  1.40088260e+00,  1.40088260e+00],
           [ 1.79899482e-04,  1.79899482e-04,  4.54869788e-04, ...,
             1.45164680e+00,  1.39968071e+00,  1.39968071e+00],
           [-9.88573869e-05, -1.76218710e-04, -1.76218710e-04, ...,
             1.51522449e+00,  1.51522449e+00,  1.51522449e+00],
           ...,
           [ 1.35881229e-04,  1.35881229e-04,  2.30342688e-04, ...,
             1.27544139e+00,  1.27544139e+00,  1.25349416e+00],
           [ 4.66288750e-05,  4.66288750e-05,  2.03097252e-06, ...,
             1.45496565e+00,  1.45496565e+00,  1.43122331e+00],
           [-3.45916659e-07, -3.45916659e-07, -1.26057670e-05, ...,
             1.47506895e+00,  1.51508310e+00,  1.51394932e+00]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>m3</span></div><div class='xr-var-dims'>(chain, draw)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>6.943e-05 6.943e-05 ... -0.2183</div><input id='attrs-2fe241c0-01c8-4ce6-a7f2-8f7d1fdf266a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2fe241c0-01c8-4ce6-a7f2-8f7d1fdf266a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cd0193f3-7ab1-4e33-82f6-fb6c79bc4f4d' class='xr-var-data-in' type='checkbox'><label for='data-cd0193f3-7ab1-4e33-82f6-fb6c79bc4f4d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 6.94279239e-05,  6.94279239e-05,  6.94279239e-05, ...,
            -2.12043774e-01, -2.12043774e-01, -2.12043774e-01],
           [ 1.05252852e-04,  1.05252852e-04,  9.55207708e-05, ...,
            -2.14273759e-01, -2.08944330e-01, -2.08944330e-01],
           [-2.83477245e-05, -2.34006542e-05, -2.34006542e-05, ...,
            -2.18100062e-01, -2.18100062e-01, -2.18100062e-01],
           ...,
           [ 7.64265228e-05,  7.64265228e-05,  7.41134683e-05, ...,
            -1.92377168e-01, -1.92377168e-01, -1.88936294e-01],
           [ 1.39817196e-04,  1.39817196e-04,  2.24125077e-04, ...,
            -2.15613268e-01, -2.15613268e-01, -2.12812648e-01],
           [-7.90783016e-06, -7.90783016e-06,  2.45984474e-06, ...,
            -2.16167417e-01, -2.18391601e-01, -2.18301053e-01]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>m4</span></div><div class='xr-var-dims'>(chain, draw)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-9.607e-05 -9.607e-05 ... 0.006819</div><input id='attrs-fb08a638-89fc-414e-93eb-c55f9aafe37d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fb08a638-89fc-414e-93eb-c55f9aafe37d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-87459793-92b4-4df0-b630-2d20a803571f' class='xr-var-data-in' type='checkbox'><label for='data-87459793-92b4-4df0-b630-2d20a803571f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-9.60718518e-05, -9.60718518e-05, -9.60718518e-05, ...,
             6.74468142e-03,  6.74468142e-03,  6.74468142e-03],
           [-1.28023765e-05, -1.28023765e-05, -1.34608263e-04, ...,
             6.69872583e-03,  6.52396831e-03,  6.52396831e-03],
           [-1.81672786e-04, -2.85460230e-04, -2.85460230e-04, ...,
             6.76298322e-03,  6.76298322e-03,  6.76298322e-03],
           ...,
           [-6.34078400e-05, -6.34078400e-05, -1.02646419e-04, ...,
             5.94923549e-03,  5.94923549e-03,  5.81006407e-03],
           [-1.42424445e-04, -1.42424445e-04, -1.74889987e-04, ...,
             6.77929767e-03,  6.77929767e-03,  6.69013763e-03],
           [-3.39530101e-06, -3.39530101e-06, -5.85863542e-06, ...,
             6.79452961e-03,  6.82141641e-03,  6.81947986e-03]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d5994bd3-80c7-48ba-a1a3-8a7e1991038f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d5994bd3-80c7-48ba-a1a3-8a7e1991038f' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>created_at :</span></dt><dd>2022-11-24T04:32:41.741514</dd><dt><span>arviz_version :</span></dt><dd>0.12.1</dd><dt><span>inference_library :</span></dt><dd>emcee</dd><dt><span>inference_library_version :</span></dt><dd>3.1.2</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 752-766

.. code-block:: default


    # a standard `trace` plot
    axes = az.plot_trace(az_idata, backend_kwargs={"constrained_layout":True}); 

    # add legends
    for i, axes_pair in enumerate(axes):
        ax1 = axes_pair[0]
        ax2 = axes_pair[1]
        #ax1.axvline(true_model[i], linestyle='dotted', color='red')
        ax1.set_xlabel("parameter value")
        ax1.set_ylabel("density value")
        ax2.set_xlabel("number of iterations")
        ax2.set_ylabel("parameter value")




.. image-sg:: /examples/generated/images/sphx_glr_linear_regression_sealevel_006.png
   :alt: m0, m0, m1, m1, m2, m2, m3, m3, m4, m4
   :srcset: /examples/generated/images/sphx_glr_linear_regression_sealevel_006.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 768-772

.. code-block:: default


    #tau = sampler.get_autocorr_time()
    #print(f"autocorrelation time: {tau}")








.. GENERATED FROM PYTHON SOURCE LINES 774-799

.. code-block:: default


    # a Corner plot

    fig, axes = plt.subplots(nparams, nparams, figsize=(12,8))

    if(True): # if we are plotting the model ensemble use this
        az.plot_pair(
            az_idata.sel(draw=slice(300,None)), 
            marginals=True, 
            #reference_values=dict(zip([f"m{i}" for i in range(4)], true_model.tolist())),
            ax=axes,
        );
    else: # if we wish to plot a kernel density plot then use this option
        az.plot_pair(
            az_idata.sel(draw=slice(300,None)), 
            marginals=True, 
            #reference_values=dict(zip([f"m{i}" for i in range(4)], true_model.tolist())),
            kind="kde",
            kde_kwargs={
                "hdi_probs": [0.3, 0.6, 0.9],  # Plot 30%, 60% and 90% HDI contours
                "contourf_kwargs": {"cmap": "Blues"},
            },
            ax=axes,
        );




.. image-sg:: /examples/generated/images/sphx_glr_linear_regression_sealevel_007.png
   :alt: linear regression sealevel
   :srcset: /examples/generated/images/sphx_glr_linear_regression_sealevel_007.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 804-807

Now we plot the predicted curves for the posterior ensemble of
solutions.


.. GENERATED FROM PYTHON SOURCE LINES 807-818

.. code-block:: default


    flat_samples = sampler.get_chain(discard=300, thin=30, flat=True)
    inds = np.random.randint(len(flat_samples), size=100) # get a random selection from posterior ensemble

    plot_data(title="Eustatic sea-level")
    plt.xlim(0,maxtime)
    plot_models(flat_samples[inds],color="lightgrey")
    plot_model(ref_x,ref_y, "Reference model", color="darkorange")
    #plt.xlim(15,20.)
    #plt.ylim(-140,-100)




.. image-sg:: /examples/generated/images/sphx_glr_linear_regression_sealevel_008.png
   :alt: Eustatic sea-level
   :srcset: /examples/generated/images/sphx_glr_linear_regression_sealevel_008.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 823-826

Expected values, credible intervals and model covariance matrix from the ensemble
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


.. GENERATED FROM PYTHON SOURCE LINES 826-832

.. code-block:: default


    print("\n Expected value and 95% credible intervals ")
    for i in range(ndim):
        mcmc = np.percentile(flat_samples[:, i], [5, 50, 95])
        print(" {} {:7.3f} [{:7.3f}, {:7.3f}]".format(labels[i],mcmc[1],mcmc[0],mcmc[2]))





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


     Expected value and 95% credible intervals 
     m0   1.449 [  1.021,   1.873]
     m1  -3.119 [ -3.566,  -2.667]
     m2   1.414 [  1.271,   1.556]
     m3  -0.209 [ -0.225,  -0.193]
     m4   0.007 [  0.006,   0.007]




.. GENERATED FROM PYTHON SOURCE LINES 834-842

.. code-block:: default


    CMpost = np.cov(flat_samples.T)
    CM_std= np.std(flat_samples,axis=0)
    print('Posterior model covariance matrix\n',CMpost)
    print('\n Posterior estimate of model standard deviations in each parameter')
    for i in range(ndim):
        print("    {} {:7.4f}".format(labels[i],CM_std[i]))





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Posterior model covariance matrix
     [[ 6.67274228e-02 -6.32043321e-02  1.68833977e-02 -1.62559983e-03
       4.81577785e-05]
     [-6.32043321e-02  7.51494697e-02 -2.25814791e-02  2.34483273e-03
      -7.26616383e-05]
     [ 1.68833977e-02 -2.25814791e-02  7.43779523e-03 -8.25348241e-04
       2.66110999e-05]
     [-1.62559983e-03  2.34483273e-03 -8.25348241e-04  9.65665039e-05
      -3.21844342e-06]
     [ 4.81577785e-05 -7.26616383e-05  2.66110999e-05 -3.21844342e-06
       1.10113697e-07]]

     Posterior estimate of model standard deviations in each parameter
        m0  0.2583
        m1  0.2741
        m2  0.0862
        m3  0.0098
        m4  0.0003




.. GENERATED FROM PYTHON SOURCE LINES 847-849

--------------


.. GENERATED FROM PYTHON SOURCE LINES 852-855

Challenge - Change the prior model bounds
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


.. GENERATED FROM PYTHON SOURCE LINES 858-903

Replace the previous prior bounds to new values

The original uniform bounds had

:math:`{\mathbf l}^T = (-10.,-10.,-10.,-10.)`, and
:math:`{\mathbf u}^T = (10.,10.,10.,10.)`.

Lets replace with

:math:`{\mathbf l}^T = (-0.5,-10.,-10.,-10.)`, and
:math:`{\mathbf u}^T = (0.5,10.,10.,10.)`.

We have only changed the bounds of the first parameter. However since
the true value of constant term was 6, these bounds are now inconsistent
with the true model.

What does this do to the posterior distribution?

Start from the code template below:

::

   m_lower_bound = <CHANGE ME>             # lower bound for uniform prior
   m_upper_bound = <CHANGE ME>             # upper bound for uniform prior

   def log_prior(model):    # uniform distribution
       for i in range(len(m_lower_bound)):
           if model[i] < m_lower_bound[i] or model[i] > m_upper_bound[i]: return -np.inf
       return 0.0 # model lies within bounds -> return log(1)

   ######## CoFI BaseProblem - update information
   inv_problem.set_log_prior(log_prior)

   ######## CoFI Inversion - run it
   inv_4 = Inversion(inv_problem, inv_options_3)
   inv_result_4 = inv_4.run()

   flat_samples = inv_result_4.sampler.get_chain(discard=300, thin=30, flat=True)
   inds = np.random.randint(len(flat_samples), size=100) # get a random selection from posterior ensemble

   print("Resulting samples with prior model lower bounds of <CHANGE ME>, upper bounds of <CHANGE ME>")
   plot_data()
   plot_models(flat_samples[inds])
   plot_model(x, true_y, "True model", color="darkorange")


.. GENERATED FROM PYTHON SOURCE LINES 903-908

.. code-block:: default


    # Copy the template above, Replace <CHANGE ME> with your answer










.. GENERATED FROM PYTHON SOURCE LINES 910-936

.. code-block:: default


    #@title Solution

    m_lower_bound = np.array([-1.0,-10,-10,-10])             # lower bound for uniform prior
    m_upper_bound = np.array([1.0,10,10,10])                 # upper bound for uniform prior

    def log_prior(model):    # uniform distribution
        for i in range(len(m_lower_bound)):
            if model[i] < m_lower_bound[i] or model[i] > m_upper_bound[i]: return -np.inf
        return 0.0 # model lies within bounds -> return log(1)

    ######## CoFI BaseProblem - update information
    inv_problem.set_log_prior(log_prior)

    ######## CoFI Inversion - run it
    inv_4 = Inversion(inv_problem, inv_options_3)
    inv_result_4 = inv_4.run()

    flat_samples = inv_result_4.sampler.get_chain(discard=300, thin=30, flat=True)
    inds = np.random.randint(len(flat_samples), size=100) # get a random selection from posterior ensemble

    print("Resulting samples with prior model lower bounds of [-1,-10,-10,-10], upper bounds of [2,10,10,10]")
    plot_data()
    plot_models(flat_samples[inds],color="lightgrey")
    plot_model(ref_x, ref_y, "Reference model", color="darkorange")




.. image-sg:: /examples/generated/images/sphx_glr_linear_regression_sealevel_009.png
   :alt: linear regression sealevel
   :srcset: /examples/generated/images/sphx_glr_linear_regression_sealevel_009.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/10000 [00:00<?, ?it/s]      0%|          | 14/10000 [00:00<01:13, 136.52it/s]      0%|          | 29/10000 [00:00<01:11, 139.21it/s]      0%|          | 44/10000 [00:00<01:11, 139.96it/s]      1%|          | 59/10000 [00:00<01:10, 140.49it/s]      1%|          | 74/10000 [00:00<01:10, 141.13it/s]      1%|          | 89/10000 [00:00<01:10, 141.51it/s]      1%|1         | 104/10000 [00:00<01:10, 141.23it/s]      1%|1         | 119/10000 [00:00<01:09, 141.42it/s]      1%|1         | 134/10000 [00:00<01:09, 141.26it/s]      1%|1         | 149/10000 [00:01<01:10, 139.24it/s]      2%|1         | 164/10000 [00:01<01:10, 140.21it/s]      2%|1         | 179/10000 [00:01<01:09, 140.78it/s]      2%|1         | 194/10000 [00:01<01:09, 141.27it/s]      2%|2         | 209/10000 [00:01<01:09, 140.61it/s]      2%|2         | 224/10000 [00:01<01:09, 141.14it/s]      2%|2         | 239/10000 [00:01<01:09, 141.42it/s]      3%|2         | 254/10000 [00:01<01:08, 141.53it/s]      3%|2         | 269/10000 [00:01<01:08, 141.70it/s]      3%|2         | 284/10000 [00:02<01:08, 141.84it/s]      3%|2         | 299/10000 [00:02<01:08, 142.01it/s]      3%|3         | 314/10000 [00:02<01:08, 142.09it/s]      3%|3         | 329/10000 [00:02<01:08, 142.21it/s]      3%|3         | 344/10000 [00:02<01:07, 142.26it/s]      4%|3         | 359/10000 [00:02<01:07, 142.30it/s]      4%|3         | 374/10000 [00:02<01:08, 141.55it/s]      4%|3         | 389/10000 [00:02<01:07, 141.87it/s]      4%|4         | 404/10000 [00:02<01:08, 141.11it/s]      4%|4         | 419/10000 [00:02<01:07, 141.45it/s]      4%|4         | 434/10000 [00:03<01:07, 141.72it/s]      4%|4         | 449/10000 [00:03<01:07, 141.91it/s]      5%|4         | 464/10000 [00:03<01:07, 142.04it/s]      5%|4         | 479/10000 [00:03<01:18, 121.70it/s]      5%|4         | 492/10000 [00:03<01:17, 122.64it/s]      5%|5         | 507/10000 [00:03<01:14, 128.12it/s]      5%|5         | 521/10000 [00:03<01:14, 127.92it/s]      5%|5         | 535/10000 [00:03<01:15, 125.63it/s]      6%|5         | 550/10000 [00:03<01:12, 130.14it/s]      6%|5         | 564/10000 [00:04<01:11, 131.38it/s]      6%|5         | 579/10000 [00:04<01:10, 134.37it/s]      6%|5         | 594/10000 [00:04<01:08, 136.59it/s]      6%|6         | 609/10000 [00:04<01:07, 138.28it/s]      6%|6         | 624/10000 [00:04<01:07, 139.37it/s]      6%|6         | 639/10000 [00:04<01:06, 140.31it/s]      7%|6         | 654/10000 [00:04<01:06, 140.99it/s]      7%|6         | 669/10000 [00:04<01:06, 141.35it/s]      7%|6         | 684/10000 [00:04<01:05, 141.70it/s]      7%|6         | 699/10000 [00:05<01:05, 141.85it/s]      7%|7         | 714/10000 [00:05<01:05, 142.05it/s]      7%|7         | 729/10000 [00:05<01:05, 142.12it/s]      7%|7         | 744/10000 [00:05<01:05, 142.22it/s]      8%|7         | 759/10000 [00:05<01:07, 136.89it/s]      8%|7         | 774/10000 [00:05<01:06, 138.53it/s]      8%|7         | 789/10000 [00:05<01:05, 139.61it/s]      8%|8         | 804/10000 [00:05<01:05, 140.46it/s]      8%|8         | 819/10000 [00:05<01:05, 139.16it/s]      8%|8         | 834/10000 [00:06<01:05, 140.10it/s]      8%|8         | 849/10000 [00:06<01:05, 140.52it/s]      9%|8         | 864/10000 [00:06<01:04, 141.03it/s]      9%|8         | 879/10000 [00:06<01:04, 141.08it/s]      9%|8         | 894/10000 [00:06<01:04, 140.47it/s]      9%|9         | 909/10000 [00:06<01:04, 141.04it/s]      9%|9         | 924/10000 [00:06<01:04, 141.48it/s]      9%|9         | 939/10000 [00:06<01:03, 141.83it/s]     10%|9         | 954/10000 [00:06<01:03, 142.01it/s]     10%|9         | 969/10000 [00:06<01:03, 142.11it/s]     10%|9         | 984/10000 [00:07<01:03, 142.19it/s]     10%|9         | 999/10000 [00:07<01:03, 142.25it/s]     10%|#         | 1014/10000 [00:07<01:03, 142.31it/s]     10%|#         | 1029/10000 [00:07<01:03, 142.34it/s]     10%|#         | 1044/10000 [00:07<01:02, 142.39it/s]     11%|#         | 1059/10000 [00:07<01:02, 142.37it/s]     11%|#         | 1074/10000 [00:07<01:02, 142.42it/s]     11%|#         | 1089/10000 [00:07<01:02, 142.47it/s]     11%|#1        | 1104/10000 [00:07<01:02, 142.49it/s]     11%|#1        | 1119/10000 [00:08<01:02, 142.49it/s]     11%|#1        | 1134/10000 [00:08<01:02, 142.50it/s]     11%|#1        | 1149/10000 [00:08<01:02, 142.52it/s]     12%|#1        | 1164/10000 [00:08<01:02, 142.49it/s]     12%|#1        | 1179/10000 [00:08<01:01, 142.53it/s]     12%|#1        | 1194/10000 [00:08<01:01, 142.52it/s]     12%|#2        | 1209/10000 [00:08<01:01, 142.52it/s]     12%|#2        | 1224/10000 [00:08<01:01, 142.57it/s]     12%|#2        | 1239/10000 [00:08<01:01, 142.47it/s]     13%|#2        | 1254/10000 [00:08<01:01, 142.52it/s]     13%|#2        | 1269/10000 [00:09<01:01, 142.49it/s]     13%|#2        | 1284/10000 [00:09<01:01, 141.83it/s]     13%|#2        | 1299/10000 [00:09<01:01, 142.05it/s]     13%|#3        | 1314/10000 [00:09<01:01, 142.21it/s]     13%|#3        | 1329/10000 [00:09<01:00, 142.27it/s]     13%|#3        | 1344/10000 [00:09<01:01, 141.55it/s]     14%|#3        | 1359/10000 [00:09<01:00, 141.84it/s]     14%|#3        | 1374/10000 [00:09<01:00, 142.08it/s]     14%|#3        | 1389/10000 [00:09<01:00, 142.24it/s]     14%|#4        | 1404/10000 [00:10<01:00, 142.32it/s]     14%|#4        | 1419/10000 [00:10<01:00, 141.89it/s]     14%|#4        | 1434/10000 [00:10<01:00, 142.02it/s]     14%|#4        | 1449/10000 [00:10<01:00, 142.14it/s]     15%|#4        | 1464/10000 [00:10<00:59, 142.28it/s]     15%|#4        | 1479/10000 [00:10<01:00, 141.61it/s]     15%|#4        | 1494/10000 [00:10<00:59, 141.88it/s]     15%|#5        | 1509/10000 [00:10<00:59, 142.09it/s]     15%|#5        | 1524/10000 [00:10<00:59, 142.18it/s]     15%|#5        | 1539/10000 [00:10<00:59, 142.33it/s]     16%|#5        | 1554/10000 [00:11<00:59, 142.40it/s]     16%|#5        | 1569/10000 [00:11<00:59, 142.47it/s]     16%|#5        | 1584/10000 [00:11<00:59, 142.54it/s]     16%|#5        | 1599/10000 [00:11<00:58, 142.57it/s]     16%|#6        | 1614/10000 [00:11<00:59, 141.52it/s]     16%|#6        | 1629/10000 [00:11<00:59, 141.86it/s]     16%|#6        | 1644/10000 [00:11<00:58, 142.11it/s]     17%|#6        | 1659/10000 [00:11<00:58, 142.26it/s]     17%|#6        | 1674/10000 [00:11<00:58, 142.37it/s]     17%|#6        | 1689/10000 [00:12<00:58, 142.44it/s]     17%|#7        | 1704/10000 [00:12<00:58, 142.47it/s]     17%|#7        | 1719/10000 [00:12<00:58, 142.41it/s]     17%|#7        | 1734/10000 [00:12<00:58, 142.49it/s]     17%|#7        | 1749/10000 [00:12<00:57, 142.51it/s]     18%|#7        | 1764/10000 [00:12<00:57, 142.58it/s]     18%|#7        | 1779/10000 [00:12<00:57, 142.19it/s]     18%|#7        | 1794/10000 [00:12<00:57, 142.27it/s]     18%|#8        | 1809/10000 [00:12<00:57, 141.63it/s]     18%|#8        | 1824/10000 [00:12<00:58, 139.88it/s]     18%|#8        | 1838/10000 [00:13<00:59, 138.32it/s]     19%|#8        | 1853/10000 [00:13<00:58, 139.62it/s]     19%|#8        | 1868/10000 [00:13<00:57, 140.51it/s]     19%|#8        | 1883/10000 [00:13<00:57, 141.18it/s]     19%|#8        | 1898/10000 [00:13<00:57, 141.56it/s]     19%|#9        | 1913/10000 [00:13<00:57, 141.87it/s]     19%|#9        | 1928/10000 [00:13<00:56, 142.10it/s]     19%|#9        | 1943/10000 [00:13<00:56, 142.06it/s]     20%|#9        | 1958/10000 [00:13<00:56, 142.18it/s]     20%|#9        | 1973/10000 [00:14<00:56, 142.32it/s]     20%|#9        | 1988/10000 [00:14<00:56, 142.38it/s]     20%|##        | 2003/10000 [00:14<00:56, 142.43it/s]     20%|##        | 2018/10000 [00:14<00:56, 142.50it/s]     20%|##        | 2033/10000 [00:14<00:55, 142.49it/s]     20%|##        | 2048/10000 [00:14<00:55, 142.54it/s]     21%|##        | 2063/10000 [00:14<00:55, 142.61it/s]     21%|##        | 2078/10000 [00:14<00:55, 142.63it/s]     21%|##        | 2093/10000 [00:14<00:55, 142.33it/s]     21%|##1       | 2108/10000 [00:14<00:55, 142.47it/s]     21%|##1       | 2123/10000 [00:15<00:56, 140.31it/s]     21%|##1       | 2138/10000 [00:15<00:55, 140.91it/s]     22%|##1       | 2153/10000 [00:15<00:55, 141.42it/s]     22%|##1       | 2168/10000 [00:15<00:55, 141.70it/s]     22%|##1       | 2183/10000 [00:15<00:55, 142.00it/s]     22%|##1       | 2198/10000 [00:15<00:54, 142.19it/s]     22%|##2       | 2213/10000 [00:15<00:54, 141.86it/s]     22%|##2       | 2228/10000 [00:15<00:54, 142.00it/s]     22%|##2       | 2243/10000 [00:15<00:54, 141.75it/s]     23%|##2       | 2258/10000 [00:16<00:54, 142.07it/s]     23%|##2       | 2273/10000 [00:16<00:55, 139.96it/s]     23%|##2       | 2288/10000 [00:16<00:56, 137.40it/s]     23%|##3       | 2302/10000 [00:16<00:55, 138.05it/s]     23%|##3       | 2316/10000 [00:16<00:55, 137.67it/s]     23%|##3       | 2331/10000 [00:16<00:55, 139.11it/s]     23%|##3       | 2346/10000 [00:16<00:54, 140.04it/s]     24%|##3       | 2361/10000 [00:16<00:54, 140.69it/s]     24%|##3       | 2376/10000 [00:16<00:53, 141.23it/s]     24%|##3       | 2391/10000 [00:16<00:54, 140.67it/s]     24%|##4       | 2406/10000 [00:17<00:53, 141.25it/s]     24%|##4       | 2421/10000 [00:17<00:53, 141.31it/s]     24%|##4       | 2436/10000 [00:17<00:53, 140.72it/s]     25%|##4       | 2451/10000 [00:17<00:53, 141.23it/s]     25%|##4       | 2466/10000 [00:17<00:53, 141.61it/s]     25%|##4       | 2481/10000 [00:17<00:53, 141.78it/s]     25%|##4       | 2496/10000 [00:17<00:52, 141.59it/s]     25%|##5       | 2511/10000 [00:17<00:52, 141.90it/s]     25%|##5       | 2526/10000 [00:17<00:53, 139.92it/s]     25%|##5       | 2541/10000 [00:18<00:53, 140.70it/s]     26%|##5       | 2556/10000 [00:18<00:52, 141.28it/s]     26%|##5       | 2571/10000 [00:18<00:52, 141.66it/s]     26%|##5       | 2586/10000 [00:18<00:52, 141.92it/s]     26%|##6       | 2601/10000 [00:18<00:52, 142.08it/s]     26%|##6       | 2616/10000 [00:18<00:52, 141.70it/s]     26%|##6       | 2631/10000 [00:18<00:51, 141.86it/s]     26%|##6       | 2646/10000 [00:18<00:51, 142.04it/s]     27%|##6       | 2661/10000 [00:18<00:51, 141.51it/s]     27%|##6       | 2676/10000 [00:19<00:52, 139.60it/s]     27%|##6       | 2691/10000 [00:19<00:52, 140.36it/s]     27%|##7       | 2706/10000 [00:19<00:51, 140.99it/s]     27%|##7       | 2721/10000 [00:19<00:51, 141.33it/s]     27%|##7       | 2736/10000 [00:19<00:51, 141.50it/s]     28%|##7       | 2751/10000 [00:19<00:51, 141.82it/s]     28%|##7       | 2766/10000 [00:19<00:51, 141.81it/s]     28%|##7       | 2781/10000 [00:19<00:50, 142.05it/s]     28%|##7       | 2796/10000 [00:19<00:50, 142.21it/s]     28%|##8       | 2811/10000 [00:19<00:50, 142.33it/s]     28%|##8       | 2826/10000 [00:20<00:50, 142.25it/s]     28%|##8       | 2841/10000 [00:20<00:50, 142.08it/s]     29%|##8       | 2856/10000 [00:20<00:50, 142.23it/s]     29%|##8       | 2871/10000 [00:20<00:50, 142.23it/s]     29%|##8       | 2886/10000 [00:20<00:49, 142.31it/s]     29%|##9       | 2901/10000 [00:20<00:49, 142.31it/s]     29%|##9       | 2916/10000 [00:20<00:49, 142.25it/s]     29%|##9       | 2931/10000 [00:20<00:49, 142.35it/s]     29%|##9       | 2946/10000 [00:20<00:49, 142.29it/s]     30%|##9       | 2961/10000 [00:21<00:49, 142.22it/s]     30%|##9       | 2976/10000 [00:21<00:49, 142.35it/s]     30%|##9       | 2991/10000 [00:21<00:49, 141.62it/s]     30%|###       | 3006/10000 [00:21<00:49, 141.85it/s]     30%|###       | 3021/10000 [00:21<00:50, 139.26it/s]     30%|###       | 3036/10000 [00:21<00:49, 140.11it/s]     31%|###       | 3051/10000 [00:21<00:49, 139.90it/s]     31%|###       | 3066/10000 [00:21<00:49, 140.70it/s]     31%|###       | 3081/10000 [00:21<00:48, 141.25it/s]     31%|###       | 3096/10000 [00:21<00:49, 140.05it/s]     31%|###1      | 3111/10000 [00:22<00:48, 140.67it/s]     31%|###1      | 3126/10000 [00:22<00:48, 141.24it/s]     31%|###1      | 3141/10000 [00:22<00:55, 122.53it/s]     32%|###1      | 3156/10000 [00:22<00:53, 127.79it/s]     32%|###1      | 3170/10000 [00:22<00:52, 130.52it/s]     32%|###1      | 3184/10000 [00:22<00:52, 130.34it/s]     32%|###1      | 3199/10000 [00:22<00:50, 133.70it/s]     32%|###2      | 3213/10000 [00:22<00:50, 134.73it/s]     32%|###2      | 3228/10000 [00:22<00:49, 136.57it/s]     32%|###2      | 3242/10000 [00:23<00:49, 137.07it/s]     33%|###2      | 3257/10000 [00:23<00:48, 138.63it/s]     33%|###2      | 3271/10000 [00:23<00:49, 136.14it/s]     33%|###2      | 3285/10000 [00:23<00:50, 132.37it/s]     33%|###3      | 3300/10000 [00:23<00:49, 134.79it/s]     33%|###3      | 3315/10000 [00:23<00:48, 136.93it/s]     33%|###3      | 3330/10000 [00:23<00:48, 138.08it/s]     33%|###3      | 3345/10000 [00:23<00:47, 139.31it/s]     34%|###3      | 3360/10000 [00:23<00:47, 140.16it/s]     34%|###3      | 3375/10000 [00:24<00:47, 140.81it/s]     34%|###3      | 3390/10000 [00:24<00:46, 141.23it/s]     34%|###4      | 3405/10000 [00:24<00:46, 141.51it/s]     34%|###4      | 3420/10000 [00:24<00:46, 141.73it/s]     34%|###4      | 3435/10000 [00:24<00:46, 141.89it/s]     34%|###4      | 3450/10000 [00:24<00:46, 142.01it/s]     35%|###4      | 3465/10000 [00:24<00:45, 142.08it/s]     35%|###4      | 3480/10000 [00:24<00:45, 142.18it/s]     35%|###4      | 3495/10000 [00:24<00:45, 142.08it/s]     35%|###5      | 3510/10000 [00:24<00:45, 141.95it/s]     35%|###5      | 3525/10000 [00:25<00:45, 142.06it/s]     35%|###5      | 3540/10000 [00:25<00:45, 142.19it/s]     36%|###5      | 3555/10000 [00:25<00:45, 142.26it/s]     36%|###5      | 3570/10000 [00:25<00:47, 136.11it/s]     36%|###5      | 3585/10000 [00:25<00:46, 137.88it/s]     36%|###6      | 3600/10000 [00:25<00:46, 139.06it/s]     36%|###6      | 3615/10000 [00:25<00:45, 140.05it/s]     36%|###6      | 3630/10000 [00:25<00:45, 138.84it/s]     36%|###6      | 3645/10000 [00:25<00:45, 139.80it/s]     37%|###6      | 3660/10000 [00:26<00:45, 140.19it/s]     37%|###6      | 3675/10000 [00:26<00:45, 140.50it/s]     37%|###6      | 3690/10000 [00:26<00:44, 140.61it/s]     37%|###7      | 3705/10000 [00:26<00:44, 140.98it/s]     37%|###7      | 3720/10000 [00:26<00:44, 140.32it/s]     37%|###7      | 3735/10000 [00:26<00:44, 140.90it/s]     38%|###7      | 3750/10000 [00:26<00:44, 141.28it/s]     38%|###7      | 3765/10000 [00:26<00:44, 141.61it/s]     38%|###7      | 3780/10000 [00:26<00:43, 141.78it/s]     38%|###7      | 3795/10000 [00:27<00:44, 140.38it/s]     38%|###8      | 3810/10000 [00:27<00:43, 140.92it/s]     38%|###8      | 3825/10000 [00:27<00:43, 140.56it/s]     38%|###8      | 3840/10000 [00:27<00:48, 128.27it/s]     39%|###8      | 3855/10000 [00:27<00:46, 132.13it/s]     39%|###8      | 3870/10000 [00:27<00:45, 134.87it/s]     39%|###8      | 3885/10000 [00:27<00:44, 136.97it/s]     39%|###9      | 3900/10000 [00:27<00:44, 138.41it/s]     39%|###9      | 3914/10000 [00:27<00:43, 138.85it/s]     39%|###9      | 3929/10000 [00:28<00:43, 139.88it/s]     39%|###9      | 3944/10000 [00:28<00:43, 140.56it/s]     40%|###9      | 3959/10000 [00:28<00:44, 135.53it/s]     40%|###9      | 3974/10000 [00:28<00:43, 137.48it/s]     40%|###9      | 3989/10000 [00:28<00:43, 138.88it/s]     40%|####      | 4004/10000 [00:28<00:42, 139.87it/s]     40%|####      | 4019/10000 [00:28<00:42, 140.57it/s]     40%|####      | 4034/10000 [00:28<00:42, 141.08it/s]     40%|####      | 4049/10000 [00:28<00:42, 140.98it/s]     41%|####      | 4064/10000 [00:28<00:42, 141.02it/s]     41%|####      | 4079/10000 [00:29<00:41, 141.37it/s]     41%|####      | 4094/10000 [00:29<00:47, 123.83it/s]     41%|####1     | 4109/10000 [00:29<00:45, 128.77it/s]     41%|####1     | 4124/10000 [00:29<00:44, 132.50it/s]     41%|####1     | 4139/10000 [00:29<00:43, 135.29it/s]     42%|####1     | 4153/10000 [00:29<00:42, 136.43it/s]     42%|####1     | 4168/10000 [00:29<00:42, 138.15it/s]     42%|####1     | 4183/10000 [00:29<00:41, 139.28it/s]     42%|####1     | 4198/10000 [00:29<00:41, 140.19it/s]     42%|####2     | 4213/10000 [00:30<00:41, 140.79it/s]     42%|####2     | 4228/10000 [00:30<00:40, 141.27it/s]     42%|####2     | 4243/10000 [00:30<00:41, 139.18it/s]     43%|####2     | 4258/10000 [00:30<00:41, 140.03it/s]     43%|####2     | 4273/10000 [00:30<00:40, 140.61it/s]     43%|####2     | 4288/10000 [00:30<00:40, 141.08it/s]     43%|####3     | 4303/10000 [00:30<00:40, 141.41it/s]     43%|####3     | 4318/10000 [00:30<00:43, 130.64it/s]     43%|####3     | 4332/10000 [00:30<00:42, 131.87it/s]     43%|####3     | 4347/10000 [00:31<00:41, 134.79it/s]     44%|####3     | 4362/10000 [00:31<00:41, 136.92it/s]     44%|####3     | 4377/10000 [00:31<00:40, 138.46it/s]     44%|####3     | 4392/10000 [00:31<00:40, 139.45it/s]     44%|####4     | 4406/10000 [00:31<00:40, 139.23it/s]     44%|####4     | 4421/10000 [00:31<00:39, 140.08it/s]     44%|####4     | 4436/10000 [00:31<00:39, 140.51it/s]     45%|####4     | 4451/10000 [00:31<00:39, 141.06it/s]     45%|####4     | 4466/10000 [00:31<00:44, 125.56it/s]     45%|####4     | 4481/10000 [00:32<00:42, 130.12it/s]     45%|####4     | 4496/10000 [00:32<00:41, 133.57it/s]     45%|####5     | 4511/10000 [00:32<00:40, 136.08it/s]     45%|####5     | 4526/10000 [00:32<00:39, 137.84it/s]     45%|####5     | 4541/10000 [00:32<00:39, 138.85it/s]     46%|####5     | 4556/10000 [00:32<00:38, 139.76it/s]     46%|####5     | 4571/10000 [00:32<00:38, 140.32it/s]     46%|####5     | 4586/10000 [00:32<00:41, 131.26it/s]     46%|####6     | 4601/10000 [00:32<00:40, 133.93it/s]     46%|####6     | 4615/10000 [00:33<00:39, 135.12it/s]     46%|####6     | 4630/10000 [00:33<00:39, 136.79it/s]     46%|####6     | 4645/10000 [00:33<00:38, 138.15it/s]     47%|####6     | 4660/10000 [00:33<00:38, 139.11it/s]     47%|####6     | 4675/10000 [00:33<00:38, 139.91it/s]     47%|####6     | 4690/10000 [00:33<00:37, 140.44it/s]     47%|####7     | 4705/10000 [00:33<00:37, 140.76it/s]     47%|####7     | 4720/10000 [00:33<00:37, 140.63it/s]     47%|####7     | 4735/10000 [00:33<00:37, 140.97it/s]     48%|####7     | 4750/10000 [00:33<00:37, 140.96it/s]     48%|####7     | 4765/10000 [00:34<00:39, 132.19it/s]     48%|####7     | 4779/10000 [00:34<00:39, 132.76it/s]     48%|####7     | 4794/10000 [00:34<00:38, 135.39it/s]     48%|####8     | 4809/10000 [00:34<00:37, 137.23it/s]     48%|####8     | 4824/10000 [00:34<00:37, 138.64it/s]     48%|####8     | 4839/10000 [00:34<00:36, 139.55it/s]     49%|####8     | 4854/10000 [00:34<00:36, 140.30it/s]     49%|####8     | 4869/10000 [00:34<00:36, 140.80it/s]     49%|####8     | 4884/10000 [00:34<00:36, 141.21it/s]     49%|####8     | 4899/10000 [00:35<00:36, 141.48it/s]     49%|####9     | 4914/10000 [00:35<00:36, 139.55it/s]     49%|####9     | 4929/10000 [00:35<00:36, 140.17it/s]     49%|####9     | 4944/10000 [00:35<00:35, 140.73it/s]     50%|####9     | 4959/10000 [00:35<00:35, 141.00it/s]     50%|####9     | 4974/10000 [00:35<00:35, 141.36it/s]     50%|####9     | 4989/10000 [00:35<00:35, 141.50it/s]     50%|#####     | 5004/10000 [00:35<00:35, 141.22it/s]     50%|#####     | 5019/10000 [00:35<00:35, 141.34it/s]     50%|#####     | 5034/10000 [00:36<00:35, 141.14it/s]     50%|#####     | 5049/10000 [00:36<00:35, 141.39it/s]     51%|#####     | 5064/10000 [00:36<00:35, 137.56it/s]     51%|#####     | 5079/10000 [00:36<00:35, 138.72it/s]     51%|#####     | 5093/10000 [00:36<00:35, 138.58it/s]     51%|#####1    | 5108/10000 [00:36<00:35, 139.39it/s]     51%|#####1    | 5123/10000 [00:36<00:34, 140.31it/s]     51%|#####1    | 5138/10000 [00:36<00:34, 139.40it/s]     52%|#####1    | 5153/10000 [00:36<00:34, 140.08it/s]     52%|#####1    | 5168/10000 [00:36<00:34, 140.64it/s]     52%|#####1    | 5183/10000 [00:37<00:34, 141.14it/s]     52%|#####1    | 5198/10000 [00:37<00:33, 141.49it/s]     52%|#####2    | 5213/10000 [00:37<00:33, 141.63it/s]     52%|#####2    | 5228/10000 [00:37<00:33, 141.85it/s]     52%|#####2    | 5243/10000 [00:37<00:33, 141.96it/s]     53%|#####2    | 5258/10000 [00:37<00:33, 141.99it/s]     53%|#####2    | 5273/10000 [00:37<00:33, 142.02it/s]     53%|#####2    | 5288/10000 [00:37<00:33, 142.06it/s]     53%|#####3    | 5303/10000 [00:37<00:34, 136.02it/s]     53%|#####3    | 5318/10000 [00:38<00:33, 137.84it/s]     53%|#####3    | 5333/10000 [00:38<00:33, 139.13it/s]     53%|#####3    | 5348/10000 [00:38<00:33, 139.98it/s]     54%|#####3    | 5363/10000 [00:38<00:33, 139.39it/s]     54%|#####3    | 5378/10000 [00:38<00:32, 140.08it/s]     54%|#####3    | 5393/10000 [00:38<00:32, 140.75it/s]     54%|#####4    | 5408/10000 [00:38<00:32, 141.16it/s]     54%|#####4    | 5423/10000 [00:38<00:33, 137.83it/s]     54%|#####4    | 5438/10000 [00:38<00:32, 138.68it/s]     55%|#####4    | 5453/10000 [00:39<00:32, 139.70it/s]     55%|#####4    | 5467/10000 [00:39<00:35, 126.87it/s]     55%|#####4    | 5481/10000 [00:39<00:35, 128.84it/s]     55%|#####4    | 5496/10000 [00:39<00:34, 132.43it/s]     55%|#####5    | 5511/10000 [00:39<00:33, 135.19it/s]     55%|#####5    | 5526/10000 [00:39<00:32, 137.07it/s]     55%|#####5    | 5541/10000 [00:39<00:32, 138.57it/s]     56%|#####5    | 5556/10000 [00:39<00:31, 139.53it/s]     56%|#####5    | 5571/10000 [00:39<00:31, 140.11it/s]     56%|#####5    | 5586/10000 [00:39<00:31, 140.59it/s]     56%|#####6    | 5601/10000 [00:40<00:31, 140.98it/s]     56%|#####6    | 5616/10000 [00:40<00:31, 141.40it/s]     56%|#####6    | 5631/10000 [00:40<00:30, 141.55it/s]     56%|#####6    | 5646/10000 [00:40<00:30, 141.77it/s]     57%|#####6    | 5661/10000 [00:40<00:30, 141.89it/s]     57%|#####6    | 5676/10000 [00:40<00:34, 126.77it/s]     57%|#####6    | 5691/10000 [00:40<00:32, 131.03it/s]     57%|#####7    | 5706/10000 [00:40<00:32, 134.12it/s]     57%|#####7    | 5721/10000 [00:40<00:31, 136.52it/s]     57%|#####7    | 5736/10000 [00:41<00:30, 138.23it/s]     58%|#####7    | 5751/10000 [00:41<00:30, 139.47it/s]     58%|#####7    | 5766/10000 [00:41<00:30, 140.26it/s]     58%|#####7    | 5781/10000 [00:41<00:29, 140.91it/s]     58%|#####7    | 5796/10000 [00:41<00:29, 140.32it/s]     58%|#####8    | 5811/10000 [00:41<00:29, 140.96it/s]     58%|#####8    | 5826/10000 [00:41<00:29, 141.46it/s]     58%|#####8    | 5841/10000 [00:41<00:29, 141.73it/s]     59%|#####8    | 5856/10000 [00:41<00:29, 141.63it/s]     59%|#####8    | 5871/10000 [00:42<00:29, 141.73it/s]     59%|#####8    | 5886/10000 [00:42<00:29, 141.61it/s]     59%|#####9    | 5901/10000 [00:42<00:28, 141.45it/s]     59%|#####9    | 5916/10000 [00:42<00:28, 141.24it/s]     59%|#####9    | 5931/10000 [00:42<00:29, 135.91it/s]     59%|#####9    | 5946/10000 [00:42<00:29, 137.70it/s]     60%|#####9    | 5961/10000 [00:42<00:29, 139.08it/s]     60%|#####9    | 5976/10000 [00:42<00:28, 140.04it/s]     60%|#####9    | 5991/10000 [00:42<00:28, 139.57it/s]     60%|######    | 6006/10000 [00:43<00:28, 140.24it/s]     60%|######    | 6021/10000 [00:43<00:28, 140.89it/s]     60%|######    | 6036/10000 [00:43<00:28, 141.30it/s]     61%|######    | 6051/10000 [00:43<00:27, 141.68it/s]     61%|######    | 6066/10000 [00:43<00:27, 141.87it/s]     61%|######    | 6081/10000 [00:43<00:27, 142.02it/s]     61%|######    | 6096/10000 [00:43<00:27, 142.15it/s]     61%|######1   | 6111/10000 [00:43<00:27, 142.30it/s]     61%|######1   | 6126/10000 [00:43<00:27, 142.35it/s]     61%|######1   | 6141/10000 [00:43<00:27, 142.33it/s]     62%|######1   | 6156/10000 [00:44<00:26, 142.42it/s]     62%|######1   | 6171/10000 [00:44<00:26, 142.47it/s]     62%|######1   | 6186/10000 [00:44<00:26, 142.41it/s]     62%|######2   | 6201/10000 [00:44<00:26, 142.41it/s]     62%|######2   | 6216/10000 [00:44<00:26, 142.31it/s]     62%|######2   | 6231/10000 [00:44<00:26, 142.43it/s]     62%|######2   | 6246/10000 [00:44<00:26, 142.50it/s]     63%|######2   | 6261/10000 [00:44<00:26, 142.60it/s]     63%|######2   | 6276/10000 [00:44<00:26, 142.66it/s]     63%|######2   | 6291/10000 [00:45<00:26, 142.50it/s]     63%|######3   | 6306/10000 [00:45<00:28, 127.91it/s]     63%|######3   | 6320/10000 [00:45<00:31, 117.62it/s]     63%|######3   | 6333/10000 [00:45<00:36, 99.58it/s]      63%|######3   | 6344/10000 [00:45<00:39, 92.64it/s]     64%|######3   | 6359/10000 [00:45<00:34, 104.64it/s]     64%|######3   | 6374/10000 [00:45<00:31, 114.33it/s]     64%|######3   | 6389/10000 [00:45<00:29, 121.83it/s]     64%|######4   | 6404/10000 [00:46<00:28, 127.27it/s]     64%|######4   | 6418/10000 [00:46<00:27, 130.74it/s]     64%|######4   | 6433/10000 [00:46<00:26, 133.49it/s]     64%|######4   | 6448/10000 [00:46<00:26, 135.93it/s]     65%|######4   | 6463/10000 [00:46<00:25, 137.84it/s]     65%|######4   | 6478/10000 [00:46<00:25, 139.12it/s]     65%|######4   | 6493/10000 [00:46<00:25, 140.21it/s]     65%|######5   | 6508/10000 [00:46<00:24, 140.82it/s]     65%|######5   | 6523/10000 [00:46<00:24, 141.01it/s]     65%|######5   | 6538/10000 [00:46<00:24, 141.22it/s]     66%|######5   | 6553/10000 [00:47<00:24, 141.63it/s]     66%|######5   | 6568/10000 [00:47<00:24, 141.69it/s]     66%|######5   | 6583/10000 [00:47<00:24, 141.70it/s]     66%|######5   | 6598/10000 [00:47<00:23, 141.98it/s]     66%|######6   | 6613/10000 [00:47<00:23, 141.88it/s]     66%|######6   | 6628/10000 [00:47<00:23, 141.70it/s]     66%|######6   | 6643/10000 [00:47<00:25, 132.09it/s]     67%|######6   | 6657/10000 [00:47<00:26, 128.57it/s]     67%|######6   | 6670/10000 [00:47<00:26, 125.48it/s]     67%|######6   | 6685/10000 [00:48<00:25, 130.35it/s]     67%|######7   | 6700/10000 [00:48<00:24, 133.93it/s]     67%|######7   | 6715/10000 [00:48<00:24, 136.46it/s]     67%|######7   | 6730/10000 [00:48<00:23, 138.28it/s]     67%|######7   | 6745/10000 [00:48<00:23, 139.17it/s]     68%|######7   | 6760/10000 [00:48<00:23, 140.05it/s]     68%|######7   | 6775/10000 [00:48<00:22, 140.91it/s]     68%|######7   | 6790/10000 [00:48<00:22, 141.50it/s]     68%|######8   | 6805/10000 [00:48<00:22, 141.55it/s]     68%|######8   | 6820/10000 [00:49<00:22, 141.92it/s]     68%|######8   | 6835/10000 [00:49<00:22, 142.19it/s]     68%|######8   | 6850/10000 [00:49<00:22, 142.44it/s]     69%|######8   | 6865/10000 [00:49<00:21, 142.55it/s]     69%|######8   | 6880/10000 [00:49<00:21, 142.63it/s]     69%|######8   | 6895/10000 [00:49<00:21, 142.66it/s]     69%|######9   | 6910/10000 [00:49<00:22, 139.08it/s]     69%|######9   | 6924/10000 [00:49<00:23, 128.64it/s]     69%|######9   | 6937/10000 [00:49<00:29, 104.76it/s]     69%|######9   | 6949/10000 [00:50<00:28, 105.79it/s]     70%|######9   | 6961/10000 [00:50<00:29, 103.32it/s]     70%|######9   | 6976/10000 [00:50<00:26, 113.48it/s]     70%|######9   | 6991/10000 [00:50<00:24, 121.04it/s]     70%|#######   | 7006/10000 [00:50<00:23, 126.93it/s]     70%|#######   | 7021/10000 [00:50<00:22, 131.10it/s]     70%|#######   | 7036/10000 [00:50<00:22, 134.16it/s]     71%|#######   | 7051/10000 [00:50<00:21, 136.76it/s]     71%|#######   | 7066/10000 [00:50<00:21, 138.71it/s]     71%|#######   | 7081/10000 [00:51<00:20, 140.08it/s]     71%|#######   | 7096/10000 [00:51<00:20, 140.97it/s]     71%|#######1  | 7111/10000 [00:51<00:20, 141.61it/s]     71%|#######1  | 7126/10000 [00:51<00:20, 142.13it/s]     71%|#######1  | 7141/10000 [00:51<00:20, 141.69it/s]     72%|#######1  | 7156/10000 [00:51<00:20, 142.10it/s]     72%|#######1  | 7171/10000 [00:51<00:19, 142.55it/s]     72%|#######1  | 7186/10000 [00:51<00:19, 142.82it/s]     72%|#######2  | 7201/10000 [00:51<00:19, 142.94it/s]     72%|#######2  | 7216/10000 [00:52<00:19, 143.10it/s]     72%|#######2  | 7231/10000 [00:52<00:19, 143.15it/s]     72%|#######2  | 7246/10000 [00:52<00:19, 142.93it/s]     73%|#######2  | 7261/10000 [00:52<00:19, 143.11it/s]     73%|#######2  | 7276/10000 [00:52<00:19, 140.96it/s]     73%|#######2  | 7291/10000 [00:52<00:19, 141.71it/s]     73%|#######3  | 7306/10000 [00:52<00:18, 142.28it/s]     73%|#######3  | 7321/10000 [00:52<00:18, 142.65it/s]     73%|#######3  | 7336/10000 [00:52<00:18, 142.06it/s]     74%|#######3  | 7351/10000 [00:52<00:18, 141.89it/s]     74%|#######3  | 7366/10000 [00:53<00:19, 136.68it/s]     74%|#######3  | 7380/10000 [00:53<00:19, 135.26it/s]     74%|#######3  | 7395/10000 [00:53<00:18, 137.12it/s]     74%|#######4  | 7410/10000 [00:53<00:18, 138.72it/s]     74%|#######4  | 7425/10000 [00:53<00:18, 139.52it/s]     74%|#######4  | 7440/10000 [00:53<00:18, 140.35it/s]     75%|#######4  | 7455/10000 [00:53<00:18, 140.94it/s]     75%|#######4  | 7470/10000 [00:53<00:17, 141.43it/s]     75%|#######4  | 7485/10000 [00:53<00:17, 141.76it/s]     75%|#######5  | 7500/10000 [00:54<00:17, 141.94it/s]     75%|#######5  | 7515/10000 [00:54<00:17, 142.13it/s]     75%|#######5  | 7530/10000 [00:54<00:17, 141.60it/s]     75%|#######5  | 7545/10000 [00:54<00:17, 141.17it/s]     76%|#######5  | 7560/10000 [00:54<00:17, 140.87it/s]     76%|#######5  | 7575/10000 [00:54<00:17, 141.25it/s]     76%|#######5  | 7590/10000 [00:54<00:17, 141.50it/s]     76%|#######6  | 7605/10000 [00:54<00:16, 141.65it/s]     76%|#######6  | 7620/10000 [00:54<00:16, 141.96it/s]     76%|#######6  | 7635/10000 [00:54<00:16, 142.22it/s]     76%|#######6  | 7650/10000 [00:55<00:16, 142.22it/s]     77%|#######6  | 7665/10000 [00:55<00:16, 142.26it/s]     77%|#######6  | 7680/10000 [00:55<00:16, 142.39it/s]     77%|#######6  | 7695/10000 [00:55<00:16, 142.50it/s]     77%|#######7  | 7710/10000 [00:55<00:16, 142.51it/s]     77%|#######7  | 7725/10000 [00:55<00:15, 142.54it/s]     77%|#######7  | 7740/10000 [00:55<00:15, 142.37it/s]     78%|#######7  | 7755/10000 [00:55<00:15, 142.41it/s]     78%|#######7  | 7770/10000 [00:55<00:15, 142.52it/s]     78%|#######7  | 7785/10000 [00:56<00:16, 131.33it/s]     78%|#######7  | 7799/10000 [00:56<00:17, 124.62it/s]     78%|#######8  | 7812/10000 [00:56<00:19, 112.25it/s]     78%|#######8  | 7827/10000 [00:56<00:18, 120.06it/s]     78%|#######8  | 7842/10000 [00:56<00:17, 126.17it/s]     79%|#######8  | 7857/10000 [00:56<00:16, 130.80it/s]     79%|#######8  | 7872/10000 [00:56<00:15, 133.98it/s]     79%|#######8  | 7887/10000 [00:56<00:15, 136.05it/s]     79%|#######9  | 7902/10000 [00:56<00:15, 137.77it/s]     79%|#######9  | 7917/10000 [00:57<00:14, 139.16it/s]     79%|#######9  | 7932/10000 [00:57<00:14, 139.91it/s]     79%|#######9  | 7947/10000 [00:57<00:14, 141.00it/s]     80%|#######9  | 7962/10000 [00:57<00:15, 128.76it/s]     80%|#######9  | 7977/10000 [00:57<00:15, 132.80it/s]     80%|#######9  | 7992/10000 [00:57<00:14, 135.60it/s]     80%|########  | 8007/10000 [00:57<00:14, 137.81it/s]     80%|########  | 8022/10000 [00:57<00:14, 139.40it/s]     80%|########  | 8037/10000 [00:57<00:13, 140.37it/s]     81%|########  | 8052/10000 [00:58<00:13, 141.24it/s]     81%|########  | 8067/10000 [00:58<00:13, 141.81it/s]     81%|########  | 8082/10000 [00:58<00:14, 128.60it/s]     81%|########  | 8096/10000 [00:58<00:14, 131.09it/s]     81%|########1 | 8111/10000 [00:58<00:14, 134.61it/s]     81%|########1 | 8126/10000 [00:58<00:13, 136.97it/s]     81%|########1 | 8141/10000 [00:58<00:13, 138.86it/s]     82%|########1 | 8156/10000 [00:58<00:13, 140.25it/s]     82%|########1 | 8171/10000 [00:58<00:13, 140.61it/s]     82%|########1 | 8186/10000 [00:59<00:12, 141.43it/s]     82%|########2 | 8201/10000 [00:59<00:12, 142.00it/s]     82%|########2 | 8216/10000 [00:59<00:14, 126.34it/s]     82%|########2 | 8231/10000 [00:59<00:13, 130.52it/s]     82%|########2 | 8246/10000 [00:59<00:13, 133.97it/s]     83%|########2 | 8261/10000 [00:59<00:12, 136.62it/s]     83%|########2 | 8276/10000 [00:59<00:12, 138.48it/s]     83%|########2 | 8291/10000 [00:59<00:12, 139.83it/s]     83%|########3 | 8306/10000 [00:59<00:12, 140.58it/s]     83%|########3 | 8321/10000 [01:00<00:11, 141.23it/s]     83%|########3 | 8336/10000 [01:00<00:11, 141.87it/s]     84%|########3 | 8351/10000 [01:00<00:11, 142.30it/s]     84%|########3 | 8366/10000 [01:00<00:11, 141.87it/s]     84%|########3 | 8381/10000 [01:00<00:11, 141.80it/s]     84%|########3 | 8396/10000 [01:00<00:11, 141.80it/s]     84%|########4 | 8411/10000 [01:00<00:11, 142.01it/s]     84%|########4 | 8426/10000 [01:00<00:11, 141.48it/s]     84%|########4 | 8441/10000 [01:00<00:11, 141.66it/s]     85%|########4 | 8456/10000 [01:00<00:10, 141.91it/s]     85%|########4 | 8471/10000 [01:01<00:10, 141.71it/s]     85%|########4 | 8486/10000 [01:01<00:10, 141.83it/s]     85%|########5 | 8501/10000 [01:01<00:10, 141.94it/s]     85%|########5 | 8516/10000 [01:01<00:10, 142.18it/s]     85%|########5 | 8531/10000 [01:01<00:10, 141.90it/s]     85%|########5 | 8546/10000 [01:01<00:10, 142.14it/s]     86%|########5 | 8561/10000 [01:01<00:10, 140.17it/s]     86%|########5 | 8576/10000 [01:01<00:10, 140.74it/s]     86%|########5 | 8591/10000 [01:01<00:09, 141.02it/s]     86%|########6 | 8606/10000 [01:02<00:09, 141.40it/s]     86%|########6 | 8621/10000 [01:02<00:09, 140.83it/s]     86%|########6 | 8636/10000 [01:02<00:09, 141.27it/s]     87%|########6 | 8651/10000 [01:02<00:09, 141.59it/s]     87%|########6 | 8666/10000 [01:02<00:09, 141.54it/s]     87%|########6 | 8681/10000 [01:02<00:09, 140.89it/s]     87%|########6 | 8696/10000 [01:02<00:10, 122.14it/s]     87%|########7 | 8710/10000 [01:02<00:10, 126.09it/s]     87%|########7 | 8723/10000 [01:03<00:12, 105.59it/s]     87%|########7 | 8735/10000 [01:03<00:11, 108.37it/s]     87%|########7 | 8747/10000 [01:03<00:13, 94.57it/s]      88%|########7 | 8758/10000 [01:03<00:13, 90.43it/s]     88%|########7 | 8769/10000 [01:03<00:13, 93.38it/s]     88%|########7 | 8783/10000 [01:03<00:11, 104.14it/s]     88%|########7 | 8797/10000 [01:03<00:10, 113.15it/s]     88%|########8 | 8811/10000 [01:03<00:09, 119.15it/s]     88%|########8 | 8826/10000 [01:03<00:09, 125.87it/s]     88%|########8 | 8841/10000 [01:04<00:08, 130.95it/s]     89%|########8 | 8855/10000 [01:04<00:09, 125.45it/s]     89%|########8 | 8868/10000 [01:04<00:08, 126.52it/s]     89%|########8 | 8883/10000 [01:04<00:08, 130.92it/s]     89%|########8 | 8898/10000 [01:04<00:08, 134.54it/s]     89%|########9 | 8913/10000 [01:04<00:07, 136.61it/s]     89%|########9 | 8928/10000 [01:04<00:07, 138.38it/s]     89%|########9 | 8943/10000 [01:04<00:07, 139.76it/s]     90%|########9 | 8958/10000 [01:04<00:07, 139.67it/s]     90%|########9 | 8973/10000 [01:05<00:07, 140.65it/s]     90%|########9 | 8988/10000 [01:05<00:07, 141.43it/s]     90%|######### | 9003/10000 [01:05<00:07, 141.97it/s]     90%|######### | 9018/10000 [01:05<00:08, 119.13it/s]     90%|######### | 9031/10000 [01:05<00:08, 119.87it/s]     90%|######### | 9046/10000 [01:05<00:07, 125.70it/s]     91%|######### | 9061/10000 [01:05<00:07, 130.12it/s]     91%|######### | 9076/10000 [01:05<00:06, 133.62it/s]     91%|######### | 9091/10000 [01:05<00:06, 136.27it/s]     91%|#########1| 9106/10000 [01:06<00:06, 138.01it/s]     91%|#########1| 9121/10000 [01:06<00:06, 139.45it/s]     91%|#########1| 9136/10000 [01:06<00:06, 140.65it/s]     92%|#########1| 9151/10000 [01:06<00:06, 141.49it/s]     92%|#########1| 9166/10000 [01:06<00:05, 140.86it/s]     92%|#########1| 9181/10000 [01:06<00:05, 141.60it/s]     92%|#########1| 9196/10000 [01:06<00:05, 141.10it/s]     92%|#########2| 9211/10000 [01:06<00:05, 141.71it/s]     92%|#########2| 9226/10000 [01:06<00:05, 142.19it/s]     92%|#########2| 9241/10000 [01:06<00:05, 140.14it/s]     93%|#########2| 9256/10000 [01:07<00:05, 141.00it/s]     93%|#########2| 9271/10000 [01:07<00:05, 139.39it/s]     93%|#########2| 9286/10000 [01:07<00:05, 140.53it/s]     93%|#########3| 9301/10000 [01:07<00:05, 135.11it/s]     93%|#########3| 9316/10000 [01:07<00:04, 137.48it/s]     93%|#########3| 9331/10000 [01:07<00:04, 138.15it/s]     93%|#########3| 9345/10000 [01:07<00:04, 137.69it/s]     94%|#########3| 9359/10000 [01:07<00:04, 134.13it/s]     94%|#########3| 9374/10000 [01:07<00:04, 136.18it/s]     94%|#########3| 9389/10000 [01:08<00:04, 137.78it/s]     94%|#########4| 9404/10000 [01:08<00:04, 139.26it/s]     94%|#########4| 9418/10000 [01:08<00:04, 138.79it/s]     94%|#########4| 9433/10000 [01:08<00:04, 140.13it/s]     94%|#########4| 9448/10000 [01:08<00:03, 139.12it/s]     95%|#########4| 9463/10000 [01:08<00:03, 140.29it/s]     95%|#########4| 9478/10000 [01:08<00:03, 141.24it/s]     95%|#########4| 9493/10000 [01:08<00:03, 141.95it/s]     95%|#########5| 9508/10000 [01:08<00:03, 125.78it/s]     95%|#########5| 9523/10000 [01:09<00:03, 130.60it/s]     95%|#########5| 9537/10000 [01:09<00:03, 131.34it/s]     96%|#########5| 9552/10000 [01:09<00:03, 134.77it/s]     96%|#########5| 9566/10000 [01:09<00:03, 135.18it/s]     96%|#########5| 9581/10000 [01:09<00:03, 137.59it/s]     96%|#########5| 9595/10000 [01:09<00:02, 136.94it/s]     96%|#########6| 9609/10000 [01:09<00:02, 137.38it/s]     96%|#########6| 9624/10000 [01:09<00:02, 139.21it/s]     96%|#########6| 9639/10000 [01:09<00:02, 139.63it/s]     97%|#########6| 9653/10000 [01:09<00:02, 135.91it/s]     97%|#########6| 9667/10000 [01:10<00:02, 126.61it/s]     97%|#########6| 9682/10000 [01:10<00:02, 131.39it/s]     97%|#########6| 9697/10000 [01:10<00:02, 134.84it/s]     97%|#########7| 9712/10000 [01:10<00:02, 137.16it/s]     97%|#########7| 9726/10000 [01:10<00:01, 137.90it/s]     97%|#########7| 9741/10000 [01:10<00:01, 137.38it/s]     98%|#########7| 9756/10000 [01:10<00:01, 138.76it/s]     98%|#########7| 9771/10000 [01:10<00:01, 140.01it/s]     98%|#########7| 9786/10000 [01:10<00:01, 139.42it/s]     98%|#########8| 9801/10000 [01:11<00:01, 140.61it/s]     98%|#########8| 9816/10000 [01:11<00:01, 141.29it/s]     98%|#########8| 9831/10000 [01:11<00:01, 141.93it/s]     98%|#########8| 9846/10000 [01:11<00:01, 142.40it/s]     99%|#########8| 9861/10000 [01:11<00:00, 141.65it/s]     99%|#########8| 9876/10000 [01:11<00:00, 141.72it/s]     99%|#########8| 9891/10000 [01:11<00:00, 142.21it/s]     99%|#########9| 9906/10000 [01:11<00:00, 142.61it/s]     99%|#########9| 9921/10000 [01:11<00:00, 125.89it/s]     99%|#########9| 9936/10000 [01:12<00:00, 130.69it/s]    100%|#########9| 9951/10000 [01:12<00:00, 134.06it/s]    100%|#########9| 9966/10000 [01:12<00:00, 136.70it/s]    100%|#########9| 9981/10000 [01:12<00:00, 138.42it/s]    100%|#########9| 9996/10000 [01:12<00:00, 139.19it/s]    100%|##########| 10000/10000 [01:12<00:00, 137.92it/s]
    Resulting samples with prior model lower bounds of [-1,-10,-10,-10], upper bounds of [2,10,10,10]




.. GENERATED FROM PYTHON SOURCE LINES 941-943

Is there much change to the posterior distribution?


.. GENERATED FROM PYTHON SOURCE LINES 946-951

--------------

Watermark
---------


.. GENERATED FROM PYTHON SOURCE LINES 951-957

.. code-block:: default


    watermark_list = ["cofi", "numpy", "scipy", "matplotlib", "emcee", "arviz"]
    for pkg in watermark_list:
        pkg_var = __import__(pkg)
        print(pkg, getattr(pkg_var, "__version__"))





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    cofi 0.1.2.dev22
    numpy 1.21.6
    scipy 1.9.1
    matplotlib 3.5.3
    emcee 3.1.2
    arviz 0.12.1





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 2 minutes  33.084 seconds)


.. _sphx_glr_download_examples_generated_linear_regression_sealevel.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: linear_regression_sealevel.py <linear_regression_sealevel.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: linear_regression_sealevel.ipynb <linear_regression_sealevel.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
